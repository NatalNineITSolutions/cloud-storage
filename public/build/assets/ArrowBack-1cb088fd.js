import{r as h,c as E,aC as tt,c8 as jn,c7 as Rt,m as C,cg as Re,ch as kn,ci as je,cj as ke,ck as vt,cl as bt,i as K,j as a,R as fe,l as Cn,aJ as Pe,aS as $e,aT as at,aU as ot,an as ne,cm as In,cn as Dn,co as lt,cp as ce,$ as ue,cq as qe,cr as We,cs as we,ct as Ce,cu as Nt,f as me,cv as Ae,n as Me,cw as de,cx as Pn,cy as Sn,cz as Tn,cA as En,cB as Rn,cC as Nn,cD as Fn,o as ge,h as Q,u as Ft,cE as zn,bV as zt,cF as On,ak as Ot,al as $t,T as O,b_ as At,cG as $n,at as pe,p as it,W as ct,B as ee,q as Ve,t as ut,A as Le,x as dt,cH as Ne,bU as An,ag as Mn,b8 as Vn,aN as Mt,cI as Ln,cJ as Vt,bN as oe,bQ as Hn,G as ie,w as Lt,y as U,cK as Bn,cL as Kn,ae as He,b9 as Be,c9 as Ht,cM as Un,ca as Bt,z as _n,S as qn,cc as Kt,I as Ke,a1 as Wn,cN as Yn,a3 as Ut,d as _t,k as Gn,e as Ue,a9 as Xn,E as ft,Y as Qn,a0 as Zn,aM as Jn,cb as es,v as ts,s as ns,F as ss,g as rs,_ as qt,cO as Wt,cP as as,cQ as os,a$ as ls}from"./main-1f8acdba.js";import{E as is,C as cs}from"./Edit-d993be71.js";function ja({children:e,isScrollable:n=!0}){return h.cloneElement(e,{className:E(e.props.className,n&&"overflow-y-auto stable-scrollbar","dashboard-grid-content")})}var B=(e=>(e.Select="select",e.DateRangePicker="dateRangePicker",e.SelectModel="selectModel",e.Input="input",e.BooleanToggle="booleanToggle",e.ChipField="chipField",e.Custom="custom",e))(B||{}),Ie=(e=>(e.eq="=",e.ne="!=",e.gt=">",e.gte=">=",e.lt="<",e.lte="<=",e.has="has",e.hasAll="hasAll",e.doesntHave="doesntHave",e.between="between",e))(Ie||{});function Yt(e){return e.set({hour:0,minute:0,second:0,millisecond:0})}function q(e){return e.set({hour:24-1,minute:60-1,second:60-1,millisecond:1e3-1})}function us(){var t,s,r;const e=(t=tt())==null?void 0:t.settings.dates.default_timezone,n=((r=(s=tt())==null?void 0:s.user)==null?void 0:r.timezone)||e||"auto";return!n||n==="auto"?jn():n}const M=Yt(Rt(us()));var Tt,Et;const Ye=((Et=(Tt=tt())==null?void 0:Tt.i18n)==null?void 0:Et.language)||"en",ht=[{key:0,label:C("Today"),getRangeValue:()=>({preset:0,start:M,end:q(M)})},{key:1,label:C("Yesterday"),getRangeValue:()=>({preset:1,start:M.subtract({days:1}),end:q(M).subtract({days:1})})},{key:2,label:C("This week"),getRangeValue:()=>({preset:2,start:Re(M,Ye),end:kn(q(M),Ye)})},{key:3,label:C("Last week"),getRangeValue:()=>{const e=Re(M,Ye).subtract({days:7});return{preset:3,start:e,end:e.add({days:6})}}},{key:4,label:C("Last 7 days"),getRangeValue:()=>({preset:4,start:M.subtract({days:7}),end:q(M)})},{key:6,label:C("Last 30 days"),getRangeValue:()=>({preset:6,start:M.subtract({days:30}),end:q(M)})},{key:7,label:C("Last 3 months"),getRangeValue:()=>({preset:7,start:M.subtract({months:3}),end:q(M)})},{key:8,label:C("Last 12 months"),getRangeValue:()=>({preset:8,start:M.subtract({months:12}),end:q(M)})},{key:9,label:C("This month"),getRangeValue:()=>({preset:9,start:je(M),end:ke(q(M))})},{key:10,label:C("This year"),getRangeValue:()=>({preset:10,start:vt(M),end:bt(q(M))})},{key:11,label:C("Last year"),getRangeValue:()=>({preset:11,start:vt(M).subtract({years:1}),end:bt(q(M)).subtract({years:1})})}],Gt=K(a.jsx("path",{d:"M7 11h2v2H7v-2zm14-5v14c0 1.1-.9 2-2 2H5c-1.11 0-2-.9-2-2l.01-14c0-1.1.88-2 1.99-2h1V2h2v2h8V2h2v2h1c1.1 0 2 .9 2 2zM5 8h14V6H5v2zm14 12V10H5v10h14zm-4-7h2v-2h-2v2zm-4 0h2v-2h-2v2z"}),"DateRangeOutlined"),Xt=fe.forwardRef((e,n)=>{const{children:t,inputProps:s,wrapperProps:r,className:o,autoFocus:l,style:i,onClick:c}=e;return a.jsx("div",{...r,onClick:c,children:a.jsx("div",{...s,role:"group",className:E(o,"flex items-center focus-within:ring focus-within:ring-primary/focus focus-within:border-primary/60"),ref:n,style:i,children:a.jsx(Cn,{autoFocus:l,children:t})})})}),mt=fe.forwardRef(({inputRef:e,wrapperProps:n,children:t,onBlur:s,...r},o)=>{const l=Pe(r),i=$e(o),{fieldProps:c,inputProps:d}=at({...r,focusRef:i,labelElementType:"span"});return l.wrapper=E(l.wrapper,r.disabled&&"pointer-events-none"),a.jsx(ot,{wrapperProps:ne(n,{onBlur:u=>{i.current.contains(u.relatedTarget)||s==null||s(u)},onClick:()=>{const u=In(i);u==null||u.focusFirst()}}),fieldClassNames:l,ref:i,...c,children:a.jsx(Xt,{inputProps:d,className:E(l.input,"gap-10"),ref:e,children:t})})});function ds(e){return e instanceof Dn?"day":"minute"}function nt(e,n,t){return n!=null&&e.compare(n)<0||t!=null&&e.compare(t)>0}function Qt(e,n){const t=lt(),[s,r]=h.useState(!1),o=n.closeDialogOnSelection??!0,l=n.granularity||ds(e),i=n.min?ce(n.min,t):void 0,c=n.max?ce(n.max,t):void 0;return{timezone:t,granularity:l,min:i,max:c,calendarIsOpen:s,setCalendarIsOpen:r,closeDialogOnSelection:o}}function gt(){const e=lt();return h.useMemo(()=>Rt(e),[e])}function fs(e){var Y,_;const n=gt(),[t,s]=h.useState({start:(!e.value||!e.value.start)&&!((Y=e.defaultValue)!=null&&Y.start),end:(!e.value||!e.value.end)&&!((_=e.defaultValue)!=null&&_.end)}),r=e.onChange,[o,l]=ue(e.value?Xe(e.value,n):void 0,e.value?void 0:Xe(e.defaultValue,n),j=>{s({start:!1,end:!1}),r==null||r(j)}),{min:i,max:c,granularity:d,timezone:u,calendarIsOpen:f,setCalendarIsOpen:m,closeDialogOnSelection:g}=Qt(o.start,e),p=h.useCallback(()=>{s({start:!0,end:!0}),l(Xe(null,n)),r==null||r(null),m(!1)},[n,l,r,m]),[v,y]=h.useState(null),[x,w]=h.useState(!1),[k,I]=h.useState(o),[N,z]=h.useState(()=>yt(o,c)),b=h.useCallback(j=>{let T=j.start,F=j.end;i&&(T=qe(T,i));const H=c?We(c,F):F;T=We(T,H);const G=i?qe(i,T):T;return F=qe(F,G),c&&(F=We(F,c)),{start:ce(T,u),end:ce(F,u)}},[i,c,u]),D=h.useCallback(j=>{const T={...b(j),preset:j.preset};l(T),I(T),z(yt(T,c)),s({start:!1,end:!1})},[l,b,c]),P=h.useCallback(j=>!t.start&&we(j,k.start)||!t.end&&we(j,k.end),[k,t]),A=h.useCallback(j=>(x||!t.start&&!t.end)&&j.compare(k.start)>=0&&j.compare(k.end)<=0,[k,t,x]),S=h.useCallback(j=>we(j,k.start),[k]),R=h.useCallback(j=>we(j,k.end),[k]),L=h.useCallback((j,T)=>({onPointerEnter:()=>{x&&T&&I(Ge({start:v,end:j,timezone:u}))},onClick:()=>{if(!x)w(!0),y(j),I(Ge({start:j,end:j,timezone:u}));else{const F=Ge({start:v,end:j,timezone:u});F.start=Yt(F.start),F.end=q(F.end),w(!1),y(null),D==null||D(F),g&&(m==null||m(!1))}}}),[v,x,D,m,g,u]);return{selectedValue:o,setSelectedValue:D,calendarIsOpen:f,setCalendarIsOpen:m,dayIsActive:P,dayIsHighlighted:A,dayIsRangeStart:S,dayIsRangeEnd:R,getCellProps:L,calendarDates:N,setIsPlaceholder:s,isPlaceholder:t,clear:p,setCalendarDates:z,min:i,max:c,granularity:d,timezone:u,closeDialogOnSelection:g}}function yt(e,n){let t=Ce(je(e.start)),s=Ce(ke(e.end));return Nt(t,s)&&(s=ke(s.add({months:1}))),n&&s.compare(n)>0&&(s=t,t=je(t.subtract({months:1}))),[t,s]}function Ge(e){const n=ce(e.start,e.timezone),t=ce(e.end,e.timezone);return n.compare(t)>0?{start:t,end:n}:{start:n,end:t}}function Xe(e,n){return e!=null&&e.start&&(e!=null&&e.end)?e:!(e!=null&&e.start)&&(e!=null&&e.end)?(e.start=e.end.subtract({months:1}),e):!(e!=null&&e.end)&&(e!=null&&e.start)?(e.end=e.start.add({months:1}),e):{start:n,end:n.add({months:1})}}const Zt=K(a.jsx("path",{d:"M16.01 11H4v2h12.01v3L20 12l-3.99-4v3z"}),"ArrowRightAltOutlined");function hs(e,n,t,s){switch(n){case"era":case"year":case"month":case"day":return e.cycle(n,t,{round:n==="year"})}if("hour"in e)switch(n){case"dayPeriod":{const r=e.hour,o=r>=12;return e.set({hour:o?r-12:r+12})}case"hour":case"minute":case"second":return e.cycle(n,t,{round:n!=="hour",hourCycle:s.hour12?12:24})}return e}function ms(e,n,t,s){switch(n){case"day":case"month":case"year":return e.set({[n]:t})}if("hour"in e)switch(n){case"dayPeriod":{const r=e.hour,o=r>=12;return t>=12===o?e:e.set({hour:o?r-12:r+12})}case"hour":if(s.hour12){const o=e.hour>=12;!o&&t===12&&(t=0),o&&t<12&&(t+=12)}case"minute":case"second":return e.set({[n]:t})}return e}const wt={year:5,month:2,day:7,hour:2,minute:15,second:15,dayPeriod:1};function gs({segment:e,domProps:n,value:t,onChange:s,isPlaceholder:r,state:{timezone:o,calendarIsOpen:l,setCalendarIsOpen:i}}){const c=me(),d=h.useRef(""),{localeCode:u}=Ae(),f=Me(),m=de({timeZone:o}),g=h.useMemo(()=>new Pn(u,{maximumFractionDigits:0}),[u]),p=b=>{s(ms(t,e.type,b,m.resolvedOptions()))},v=b=>{s(hs(t,e.type,b,m.resolvedOptions()))},y=()=>{if(g.isValidPartialNumber(e.text)){const b=e.text.slice(0,-1),D=g.parse(b);if(b.length===0||D===0){const P=Sn(o);e.type in P&&p(P[e.type])}else p(D);d.current=b}else e.type==="dayPeriod"&&v(-1)},x=b=>{var D;if(!(b.ctrlKey||b.metaKey||b.shiftKey||b.altKey)){switch(b.key){case"ArrowLeft":b.preventDefault(),b.stopPropagation(),f==null||f.focusPrevious();break;case"ArrowRight":b.preventDefault(),b.stopPropagation(),f==null||f.focusNext();break;case"Enter":(D=b.target.closest("form"))==null||D.requestSubmit(),i(!l);break;case"Tab":break;case"Backspace":case"Delete":{b.preventDefault(),b.stopPropagation(),y();break}case"ArrowUp":b.preventDefault(),d.current="",v(1);break;case"ArrowDown":b.preventDefault(),d.current="",v(-1);break;case"PageUp":b.preventDefault(),d.current="",v(wt[e.type]||1);break;case"PageDown":b.preventDefault(),d.current="",v(-(wt[e.type]||1));break;case"Home":b.preventDefault(),d.current="",p(e.maxValue);break;case"End":b.preventDefault(),d.current="",p(e.minValue);break}N(b.key)}},w=de({hour:"numeric",hour12:!0}),k=h.useMemo(()=>{const b=new Date;return b.setHours(0),w.formatToParts(b).find(D=>D.type==="dayPeriod").value},[w]),I=h.useMemo(()=>{const b=new Date;return b.setHours(12),w.formatToParts(b).find(D=>D.type==="dayPeriod").value},[w]),N=b=>{const D=d.current+b;switch(e.type){case"dayPeriod":if(k.toLowerCase().startsWith(b))p(0);else if(I.toLowerCase().startsWith(b))p(12);else break;f==null||f.focusNext();break;case"day":case"hour":case"minute":case"second":case"month":case"year":{if(!g.isValidPartialNumber(D))return;let P=g.parse(D),A=P,S=e.minValue===0;if(e.type==="hour"&&m.resolvedOptions().hour12){switch(m.resolvedOptions().hourCycle){case"h11":P>11&&(A=g.parse(b));break;case"h12":S=!1,P>12&&(A=g.parse(b));break}e.value>=12&&P>1&&(P+=12)}else P>e.maxValue&&(A=g.parse(b));if(Number.isNaN(P))return;const R=A!==0||S;R&&p(A),+`${P}0`>e.maxValue||D.length>=String(e.maxValue).length?(d.current="",R&&(f==null||f.focusNext())):d.current=D;break}}},z=c?{}:{"aria-label":e.type,"aria-valuetext":r?void 0:`${e.value}`,"aria-valuemin":e.minValue,"aria-valuemax":e.maxValue,"aria-valuenow":r?void 0:e.value,tabIndex:0,onKeyDown:x};return a.jsx("div",{...ne(n,{...z,onFocus:b=>{d.current="",b.target.scrollIntoView({block:"nearest"})},onClick:b=>{b.preventDefault(),b.stopPropagation()}}),className:"box-content cursor-default select-none whitespace-nowrap rounded p-2 text-center tabular-nums caret-transparent outline-none focus:bg-primary focus:text-on-primary",children:e.text.padStart(e.minLength,"0")})}function ps({segment:e,domProps:n}){const t=Me();return a.jsx("div",{...n,onPointerDown:s=>{s.pointerType==="mouse"&&(s.preventDefault(),t!=null&&t.focusNext({from:s.target})||t==null||t.focusPrevious({from:s.target}))},"aria-hidden":!0,className:"min-w-4 cursor-default select-none",children:e.text})}function xs(e,n,t){switch(n){case"year":return{value:e.year,placeholder:"yyyy",minValue:1,maxValue:e.calendar.getYearsInEra(e)};case"month":return{value:e.month,placeholder:"mm",minValue:En(e),maxValue:e.calendar.getMonthsInYear(e)};case"day":return{value:e.day,minValue:Tn(e),maxValue:e.calendar.getDaysInMonth(e),placeholder:"dd"}}if("hour"in e)switch(n){case"dayPeriod":return{value:e.hour>=12?12:0,minValue:0,maxValue:12,placeholder:"--"};case"hour":if(t.hour12){const s=e.hour>=12;return{value:e.hour,minValue:s?12:0,maxValue:s?23:11,placeholder:"--"}}return{value:e.hour,minValue:0,maxValue:23,placeholder:"--"};case"minute":return{value:e.minute,minValue:0,maxValue:59,placeholder:"--"}}return{}}function De({segmentProps:e,state:n,value:t,onChange:s,isPlaceholder:r}){const{granularity:o}=n,l=h.useMemo(()=>{const u={year:"numeric",month:"numeric",day:"numeric"};return o==="minute"&&(u.hour="numeric",u.minute="numeric"),u},[o]),i=de(l),c=h.useMemo(()=>t.toDate(),[t]),d=h.useMemo(()=>i.formatToParts(c).map(u=>{const f=xs(t,u.type,i.resolvedOptions()),m=r&&u.type!=="literal"?f.placeholder:u.value;return{type:u.type,text:u.value===", "?" ":m,...f,minLength:u.type!=="literal"?String(f.maxValue).length:1}}),[c,i,r,t]);return a.jsx("div",{className:"flex items-center",children:d.map((u,f)=>u.type==="literal"?a.jsx(ps,{domProps:e,segment:u},f):a.jsx(gs,{isPlaceholder:r,domProps:e,state:n,value:t,onChange:s,segment:u},f))})}const Jt=K(a.jsx("path",{d:"M15.41 16.59 10.83 12l4.58-4.59L14 6l-6 6 6 6 1.41-1.41z"}),"KeyboardArrowLeftOutlined"),en=K(a.jsx("path",{d:"M8.59 16.59 13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"}),"KeyboardArrowRightOutlined");function vs({date:e,currentMonth:n,state:{dayIsActive:t,dayIsHighlighted:s,dayIsRangeStart:r,dayIsRangeEnd:o,getCellProps:l,timezone:i,min:c,max:d}}){const{localeCode:u}=Ae(),f=Rn(e,u),m=t(e),g=s(e),p=r(e),v=o(e),y=Nn(e,i),x=Nt(e,n),w=nt(e,c,d);return a.jsxs("div",{role:"button","aria-disabled":w,className:E("w-40 h-40 text-sm relative isolate flex-shrink-0",w&&"text-disabled pointer-events-none",!x&&"invisible pointer-events-none"),...l(e,x),children:[a.jsx("span",{className:E("absolute inset-0 flex items-center justify-center rounded-full w-full h-full select-none z-10 cursor-pointer",!m&&!y&&"hover:bg-hover",m&&"bg-primary text-on-primary font-semibold",y&&!m&&"bg-chip"),children:e.day}),g&&x&&a.jsx("span",{className:E("absolute w-full h-full inset-0 bg-primary/focus",(p||f===0||e.day===1)&&"rounded-l-full",(v||f===6||e.day===n.calendar.getDaysInMonth(n))&&"rounded-r-full")})]})}function bs({startDate:e,state:n,isFirst:t,isLast:s}){const{localeCode:r}=Ae(),o=Fn(e,r),l=Re(e,r);return a.jsxs("div",{className:"w-280 flex-shrink-0",children:[a.jsx(ys,{isFirst:t,isLast:s,state:n,currentMonth:e}),a.jsxs("div",{className:"block",role:"grid",children:[a.jsx(ws,{state:n,startDate:e}),[...new Array(o).keys()].map(i=>a.jsx(ge.div,{className:"flex mb-6",children:[...new Array(7).keys()].map(c=>a.jsx(vs,{date:l.add({weeks:i,days:c}),currentMonth:e,state:n},c))},i))]})]})}function ys({currentMonth:e,isFirst:n,isLast:t,state:{calendarDates:s,setCalendarDates:r,timezone:o,min:l,max:i}}){const c=m=>{const g=s.length;let p;m==="forward"?p=s.map(v=>ke(v.add({months:g}))):p=s.map(v=>ke(v.subtract({months:g}))),r(p)},d=de({month:"long",year:"numeric",era:e.calendar.identifier!=="gregory"?"long":void 0,calendar:e.calendar.identifier}),u=nt(e.subtract({days:1}),l,i),f=nt(je(e.add({months:1})),l,i);return a.jsxs("div",{className:"flex items-center justify-between gap-10",children:[a.jsx(Q,{size:"md",className:E("text-muted",!n&&"invisible"),disabled:!n||u,"aria-hidden":!n,onClick:()=>{c("backward")},children:a.jsx(Jt,{})}),a.jsx("div",{className:"text-sm font-semibold select-none",children:d.format(e.toDate(o))}),a.jsx(Q,{size:"md",className:E("text-muted",!t&&"invisible"),disabled:!t||f,"aria-hidden":!t,onClick:()=>{c("forward")},children:a.jsx(en,{})})]})}function ws({state:{timezone:e},startDate:n}){const{localeCode:t}=Ae(),s=de({weekday:"short"}),r=Re(n,t);return a.jsx("div",{className:"flex",children:[...new Array(7).keys()].map(o=>{const i=r.add({days:o}).toDate(e),c=s.format(i);return a.jsx("div",{className:"w-40 h-40 text-sm font-semibold relative flex-shrink-0",children:a.jsx("div",{className:"absolute flex items-center justify-center w-full h-full select-none",children:c})},o)})})}function tn({state:e,visibleMonths:n=1}){return me()&&(n=1),a.jsx(h.Fragment,{children:[...new Array(n).keys()].map(s=>{const r=Ce(je(e.calendarDates[s])),o=s===0,l=s===n-1;return a.jsx(bs,{state:e,startDate:r,isFirst:o,isLast:l},s)})})}const nn=h.memo(({start:e,end:n,options:t,preset:s})=>{const{dates:r}=Ft(),o=lt(),l=de(t||zn[s||(r==null?void 0:r.format)]);if(!e||!n)return null;let i;try{i=l.formatRange(jt(e,o),jt(n,o))}catch{i=""}return a.jsx(h.Fragment,{children:i})},zt);function jt(e,n){return typeof e=="string"?On(e,n).toDate():"toDate"in e?e.toDate(n):e}function js({onPresetSelected:e,selectedValue:n}){return a.jsx(Ot,{children:ht.map(t=>a.jsx($t,{borderRadius:"rounded-none",capitalizeFirst:!0,isSelected:(n==null?void 0:n.preset)===t.key,onSelected:()=>{const s=t.getRangeValue();e(s)},children:a.jsx(O,{...t.label})},t.key))})}function ks(e){return At("(max-width: 1024px)",e)}const sn=fe.forwardRef((e,n)=>{const{children:t,size:s="sm",description:r,className:o,invalid:l,autoFocus:i,errorMessage:c,...d}=e,u=$e(n);$n({autoFocus:i},u);const f=Cs(s),m=Pe(e),g=h.useId();return a.jsxs("div",{className:E(o,"isolate"),children:[a.jsxs("label",{className:"flex items-center select-none",children:[a.jsx("input",{...d,type:"checkbox",role:"switch","aria-invalid":l||void 0,"aria-describedby":r?g:void 0,ref:u,"aria-checked":d.checked,className:E(f,!l&&"checked:bg-primary dark:checked:bg-primary-dark checked:border-primary dark:checked:border-primary-dark",l&&"checked:bg-danger checked:border-danger","outline-none cursor-pointer bg-chip border-chip border checked:bg-primary checked:border-primary p-0 overflow-hidden relative rounded-3xl appearance-none transition-colors flex-shrink-0 flex items-center outline-none","before:z-10 before:border before:rounded-3xl before:block before:bg-white before:transition-transform before:translate-x-2","checked:before:border-white","focus-visible:ring",e.disabled&&"opacity-80 cursor-not-allowed")}),t&&a.jsx("span",{className:E(m.size.font,"ml-12",l&&"text-danger",e.disabled&&"text-disabled"),children:t})]}),r&&!c&&a.jsx("div",{id:g,className:m.description,children:r}),c&&a.jsx("div",{id:g,className:m.error,children:c})]})});function ka(e){const{field:{onChange:n,onBlur:t,value:s=!1,ref:r},fieldState:{invalid:o,error:l}}=pe({name:e.name}),i={onChange:c=>{c.target.value&&c.target.value!=="on"?n(c.target.checked?c.target.value:!1):n(c)},onBlur:t,checked:!!s,invalid:o,errorMessage:l==null?void 0:l.message,name:e.name};return a.jsx(sn,{ref:r,...ne(e,i)})}function Cs(e){switch(e){case"xl":return"w-68 h-36 before:w-28 before:h-28 checked:before:translate-x-36";case"lg":return"w-56 h-30 before:w-22 before:h-22 checked:before:translate-x-30";case"md":return"w-46 h-24 before:w-18 before:h-18 checked:before:translate-x-24";case"xs":return"w-30 h-16 before:w-12 before:h-12 checked:before:translate-x-16";default:return"w-38 h-20 before:w-14 before:h-14 checked:before:translate-x-20"}}const Is=[{key:0,label:C("Preceding period"),getRangeValue:e=>{const n=e.start,r=(e.end.toDate().getTime()-n.toDate().getTime())/(1e3*60);return{preset:0,start:n.subtract({minutes:r}),end:n}}},{key:1,label:C("Same period last year"),getRangeValue:e=>({start:e.start.subtract({years:1}),end:e.end.subtract({years:1}),preset:1})},{key:2,label:C("Custom"),getRangeValue:e=>({start:e.start.subtract({weeks:1}),end:e.end.subtract({weeks:1}),preset:2})}];function Ds({originalRangeValue:e,onPresetSelected:n,selectedValue:t}){return a.jsx(Ot,{children:Is.map(s=>a.jsx($t,{borderRadius:"rounded-none",capitalizeFirst:!0,isSelected:(t==null?void 0:t.preset)===s.key,onSelected:()=>{const r=s.getRangeValue(e);n(r)},children:a.jsx(O,{...s.label})},s.key))})}function Ps({state:e,compareState:n,showInlineDatePickerField:t=!1,compareVisibleDefault:s=!1}){const r=ks(),{close:o}=it(),l=h.useRef(e),i=e.isPlaceholder.start||e.isPlaceholder.end,[c,d]=h.useState(s),u=a.jsxs(ct,{dividerTop:!0,startAction:!i&&!r?a.jsx("div",{className:"text-xs",children:a.jsx(nn,{start:e.selectedValue.start.toDate(),end:e.selectedValue.end.toDate(),options:{dateStyle:"medium"}})}):void 0,children:[a.jsx(ee,{variant:"text",size:"xs",onClick:()=>{e.setSelectedValue(l.current.selectedValue),e.setIsPlaceholder(l.current.isPlaceholder),o()},children:a.jsx(O,{message:"Cancel"})}),a.jsx(ee,{variant:"flat",color:"primary",size:"xs",onClick:()=>{const f=e.selectedValue;n&&c&&(f.compareStart=n.selectedValue.start,f.compareEnd=n.selectedValue.end),o(f)},children:a.jsx(O,{message:"Select"})})]});return a.jsxs(Ve,{size:"auto",children:[a.jsxs(ut,{className:"flex",padding:"p-0",children:[!r&&a.jsxs("div",{className:"min-w-192 py-14",children:[a.jsx(js,{selectedValue:e.selectedValue,onPresetSelected:f=>{e.setSelectedValue(f),e.closeDialogOnSelection&&o(f)}}),!!n&&a.jsxs(h.Fragment,{children:[a.jsx(sn,{className:"mx-20 mb-10 mt-14",checked:c,onChange:f=>d(f.target.checked),children:a.jsx(O,{message:"Compare"})}),c&&a.jsx(Ds,{originalRangeValue:e.selectedValue,selectedValue:n.selectedValue,onPresetSelected:f=>{n.setSelectedValue(f)}})]})]}),a.jsx(Le,{initial:!1,children:a.jsx(Ss,{state:e,compareState:n,showInlineDatePickerField:t,compareVisible:c})})]}),!e.closeDialogOnSelection&&u]})}function Ss({state:e,compareState:n,showInlineDatePickerField:t,compareVisible:s}){return a.jsxs(ge.div,{initial:{width:0,overflow:"hidden"},animate:{width:"auto"},exit:{width:0,overflow:"hidden"},transition:{type:"tween",duration:.125},className:"border-l px-20 pb-20 pt-10",children:[t&&a.jsxs("div",{children:[a.jsx(kt,{state:e}),!!n&&s&&a.jsx(kt,{state:n,label:a.jsx(O,{message:"Compare"})})]}),a.jsx("div",{className:"flex items-start gap-36",children:a.jsx(tn,{state:e,visibleMonths:2})})]})}function kt({state:e,label:n}){const{selectedValue:t,setSelectedValue:s}=e;return a.jsxs(mt,{className:"mb-20 mt-10",label:n,children:[a.jsx(De,{state:e,value:t.start,onChange:r=>{s({...t,start:r})}}),a.jsx(Zt,{className:"block flex-shrink-0 text-muted",size:"md"}),a.jsx(De,{state:e,value:t.end,onChange:r=>{s({...t,end:r})}})]})}function Ts(e){var m,g;const{granularity:n,closeDialogOnSelection:t,...s}=e,r=fs(e),o=h.useRef(null),i=me()&&n!=="day",c=a.jsx(dt,{offset:8,placement:"bottom-start",isOpen:r.calendarIsOpen,onOpenChange:r.setCalendarIsOpen,type:"popover",triggerRef:o,returnFocusToTrigger:!1,moveFocusToDialog:!1,children:a.jsx(Ps,{state:r})}),d={onClick:p=>{p.stopPropagation(),p.preventDefault(),Es(p)?r.setCalendarIsOpen(!1):r.setCalendarIsOpen(!0)}},u=r.selectedValue,f=r.setSelectedValue;return a.jsxs(h.Fragment,{children:[a.jsxs(mt,{ref:o,wrapperProps:d,endAdornment:i?void 0:a.jsx(Gt,{}),...s,children:[a.jsx(De,{isPlaceholder:(m=r.isPlaceholder)==null?void 0:m.start,state:r,segmentProps:d,value:u.start,onChange:p=>{f({start:p,end:u.end})}}),a.jsx(Zt,{className:"block flex-shrink-0 text-muted",size:"md"}),a.jsx(De,{isPlaceholder:(g=r.isPlaceholder)==null?void 0:g.end,state:r,segmentProps:d,value:u.end,onChange:p=>{f({start:u.start,end:p})}})]}),c]})}function Es(e){return["hour","minute","dayPeriod"].includes(e.currentTarget.ariaLabel||"")}function Rs(e){const{field:{onChange:n,onBlur:t,value:s,ref:r},fieldState:{invalid:o,error:l}}=pe({name:e.name}),i={onChange:c=>{n(c?rn(c):null)},onBlur:t,value:Ns(s),invalid:o,errorMessage:l==null?void 0:l.message,inputRef:r};return a.jsx(Ts,{...ne(i,e)})}function Ns(e){const{start:n,end:t,preset:s}=e||{},r={preset:s};try{n&&(r.start=typeof n=="string"?Ne(n):n),t&&(r.end=typeof t=="string"?Ne(t):t)}catch{}return r}function rn({start:e,end:n,preset:t}={}){const s={preset:t};return e&&(s.start=e.toAbsoluteString()),n&&(s.end=n.toAbsoluteString()),s}function an(e){var n;return{...e,defaultOperator:Ie.between,control:{type:B.DateRangePicker,defaultValue:((n=e.control)==null?void 0:n.defaultValue)||rn(ht[3].getRangeValue())}}}function Fs(e){return an({key:"created_at",label:C("Date created"),...e})}function zs(e){return an({key:"updated_at",label:C("Last updated"),...e})}const Qe="filters";function Os(e){if(!e)return[];let n=[];try{n=JSON.parse(atob(decodeURIComponent(e))),n.map(t=>(t.valueKey!=null&&(t.value=t.valueKey),t))}catch{}return n}function $s(e,n){return!e||(e=n?e.filter(t=>t.value!=="").map(t=>As(t,n)):e,e=e.filter(t=>!t.isInactive),!e.length)?"":encodeURIComponent(btoa(JSON.stringify(e)))}function As(e,n){var s;const t=n.find(r=>r.key===e.key);if((t==null?void 0:t.control.type)==="select"){const r=(t.control.options||[]).find(o=>o.key===e.value);if(r)return{...e,value:r.value,valueKey:r.key}}return(s=t==null?void 0:t.extraFilters)!=null&&s.length&&(e.extraFilters=t.extraFilters),e}function Ms(e,n){const[t]=An(),s=Mn(),r=t.get(Qe),o=h.useMemo(()=>{if(!e)return[];const u=Os(r);return(n||[]).forEach(f=>{if(!u.find(m=>m.key===f)){const m=e.find(g=>g.key===f);u.push({key:f,value:m.control.defaultValue,operator:m.defaultOperator,isInactive:!0})}}),u.sort((f,m)=>e.findIndex(g=>g.key===f.key)-e.findIndex(g=>g.key===m.key)),u},[r,n,e]),l=h.useCallback(u=>{const f=[...o];return u.forEach(m=>{const g=typeof m=="object"?m.key:m,p=f.findIndex(v=>v.key===g);p>-1&&f.splice(p,1)}),f},[o]),i=h.useCallback(u=>{const f=$s(u,e);f?t.set(Qe,f):t.delete(Qe),s({search:`?${t}`},{replace:!0})},[e,s,t]),c=h.useCallback(u=>{const m=[...l(u),...u];i(m)},[l,i]),d=h.useCallback(u=>i(l([u])),[l,i]);return{add:c,remove:d,replaceAll:i,decodedFilters:o,encodedFilters:r}}function Fe(e){return Vn()?e.metaKey:e.ctrlKey}function Vs(e){const{cellCount:n,rowCount:t}=e;return{onKeyDown:r=>{switch(r.key){case"ArrowLeft":X(r,{cell:{op:"decrement"}},e);break;case"ArrowRight":X(r,{cell:{op:"increment"}},e);break;case"ArrowUp":X(r,{row:{op:"decrement"}},e);break;case"ArrowDown":X(r,{row:{op:"increment"}},e);break;case"PageUp":X(r,{row:{op:"decrement",count:5}},e);break;case"PageDown":X(r,{row:{op:"increment",count:5}},e);break;case"Tab":Ls(r);break;case"Home":Fe(r)?X(r,{row:{op:"decrement",count:t},cell:{op:"decrement",count:n}},e):X(r,{cell:{op:"decrement",count:n}},e);break;case"End":Fe(r)?X(r,{row:{op:"increment",count:t},cell:{op:"increment",count:n}},e):X(r,{cell:{op:"increment",count:n}},e);break}}}}function X(e,n,{cellCount:t,rowCount:s}){var p,v,y,x,w,k,I;if(((p=document.activeElement)==null?void 0:p.tagName)==="input")return;e.preventDefault();const r=e.currentTarget,o=e.target.closest("[aria-colindex]");if(!o||!r)return;const l=o.closest("[aria-rowindex]");if(!l)return;let i=parseInt(l.getAttribute("aria-rowindex")),c=parseInt(o.getAttribute("aria-colindex"));if(Number.isNaN(i)||Number.isNaN(c))return;const d=((v=n.row)==null?void 0:v.count)??1;((y=n.row)==null?void 0:y.op)==="increment"?i=Math.min(s,i+d):((x=n.row)==null?void 0:x.op)==="decrement"&&(i=Math.max(1,i-d));const u=((w=n.cell)==null?void 0:w.count)??1;((k=n.cell)==null?void 0:k.op)==="increment"?c=Math.min(t,c+u):((I=n.cell)==null?void 0:I.op)==="decrement"&&(c=Math.max(1,c-u));const f=r.querySelector(`[aria-rowindex="${i}"] [aria-colindex="${c}"]`);if(!f)return;const g=Mt(f).nextNode()||f;o.setAttribute("tabindex","-1"),g.setAttribute("tabindex","0"),g.focus()}function Ls(e){const n=e.currentTarget;if(e.shiftKey)n.focus();else{const t=Mt(n,{tabbable:!0});let s,r;do r=t.lastChild(),r&&(s=r);while(r);s&&!s.contains(document.activeElement)&&Ln(s)}}const Z=h.createContext(null);function on({index:e,isHeader:n}){const{columns:t,cellHeight:s="h-46",headerCellHeight:r="h-46"}=h.useContext(Z),o=t[e],l=o==null?void 0:o.padding;let i="justify-start";return(o==null?void 0:o.align)==="center"?i="justify-center":(o==null?void 0:o.align)==="end"&&(i="justify-end"),E("flex items-center overflow-hidden whitespace-nowrap overflow-ellipsis outline-none focus-visible:outline focus-visible:outline-offset-2",n?r:s,(o==null?void 0:o.width)??"flex-1",o==null?void 0:o.maxWidth,o==null?void 0:o.minWidth,i,l,o==null?void 0:o.className)}function Hs({rowIndex:e,rowIsHovered:n,index:t,item:s,id:r}){const{columns:o}=h.useContext(Z),l=o[t],i=h.useMemo(()=>({index:e,isHovered:n,isPlaceholder:s.isPlaceholder}),[e,n,s.isPlaceholder]),c=on({index:t,isHeader:!1});return a.jsx("div",{tabIndex:-1,role:"gridcell","aria-colindex":t+1,id:r,className:c,children:a.jsx("div",{className:"overflow-x-hidden overflow-ellipsis min-w-0 w-full",children:l.body(s,i)})})}function Bs({onMoveStart:e,onMove:n,onMoveEnd:t,minimumMovement:s=0,preventDefault:r,stopPropagation:o=!0,onPress:l,onLongPress:i,...c}){const u=h.useRef({lastPosition:{x:0,y:0},started:!1,longPressTriggered:!1}).current,{addGlobalListener:f,removeGlobalListener:m}=Vt(),g=x=>{!u.el||(e==null?void 0:e(x,u.el))===!1||(u.originalTouchAction=u.el.style.touchAction,u.el.style.touchAction="none",u.originalUserSelect=document.documentElement.style.userSelect,document.documentElement.style.userSelect="none",u.started=!0)},p=x=>{var w;if(x.button===0&&u.id==null){if(u.started=!1,((w=c.onPointerDown)==null?void 0:w.call(c,x))===!1)return;o&&x.stopPropagation(),r&&x.preventDefault(),u.id=x.pointerId,u.el=x.currentTarget,u.lastPosition={x:x.clientX,y:x.clientY},i&&(u.longPressTimer=setTimeout(()=>{i(x,u.el),u.longPressTriggered=!0},400)),(e||n)&&f(window,"pointermove",v,!1),f(window,"pointerup",y,!1),f(window,"pointercancel",y,!1)}},v=x=>{if(x.pointerId===u.id){const w=x.clientX-u.lastPosition.x,k=x.clientY-u.lastPosition.y;(Math.abs(w)>=s||Math.abs(k)>=s)&&!u.started&&g(x),u.started&&(n==null||n(x,w,k),u.lastPosition={x:x.clientX,y:x.clientY})}},y=x=>{var w;if(x.pointerId===u.id){u.longPressTimer&&clearTimeout(u.longPressTimer);const k=u.longPressTriggered;u.longPressTriggered=!1,u.started&&(t==null||t(x)),u.el&&(x.type!=="pointercancel"&&((w=c.onPointerUp)==null||w.call(c,x,u.el),x.target&&u.el.contains(x.target)&&(k?i==null||i(x,u.el):l==null||l(x,u.el))),document.documentElement.style.userSelect=u.originalUserSelect||"",u.el.style.touchAction=u.originalTouchAction||""),u.id=void 0,u.started=!1,m(window,"pointermove",v,!1),m(window,"pointerup",y,!1),m(window,"pointercancel",y,!1)}};return{domProps:{onPointerDown:oe(p)}}}function Ks(e){return e.shiftKey||Fe(e)}function Us({index:e,isSelected:n,isHeader:t}){const s=Hn(),r=me(),{hideBorder:o,enableSelection:l,collapseOnMobile:i,onAction:c}=h.useContext(Z);return E("flex gap-x-16 break-inside-avoid outline-none border border-transparent",c&&"cursor-pointer",r&&i&&o?"mb-8 pl-8 pr-0 rounded":"px-16",!o&&"border-b-divider",!o&&e===0&&"border-t-divider",n&&!s&&"bg-primary/selected hover:bg-primary/focus focus-visible:bg-primary/focus",n&&s&&"bg-selected hover:bg-focus focus-visible:bg-focus",!n&&!t&&(l||c)&&"focus-visible:bg-focus hover:bg-hover")}const _s=["button","a","input","select","textarea"];function qs({item:e,index:n,renderAs:t,className:s,style:r}){const{selectedRows:o,columns:l,toggleRow:i,selectRow:c,onAction:d,selectRowOnContextMenu:u,enableSelection:f,selectionStyle:m,hideHeaderRow:g}=h.useContext(Z),p=h.useRef(!1),v=o.includes(e.id),[y,x]=h.useState(!1),w=S=>S.target.closest(_s.join(",")),k=S=>{m==="highlight"&&d&&!p.current&&!w(S)&&(S.preventDefault(),S.stopPropagation(),d(e,n))},I=!!o.length,N=S=>{w(S)||(m==="checkbox"?f&&(I||!d)?i(e):d&&d(e,n):m==="highlight"&&(p.current?f&&I?i(e):d==null||d(e,n):f&&c(e,Ks(S))))},{domProps:z}=Bs({onPointerDown:S=>{p.current=S.pointerType==="touch"},onPress:N,onLongPress:f?()=>{p.current&&i(e)}:void 0}),b=S=>{f&&S.key===" "?(S.preventDefault(),S.stopPropagation(),m==="checkbox"?i(e):c(e)):S.key==="Enter"&&!o.length&&d&&(S.preventDefault(),S.stopPropagation(),d(e,n))},D=S=>{u&&f&&(o.includes(e.id)||c(e)),p.current&&(S.preventDefault(),S.stopPropagation())},P=Us({index:n,isSelected:v}),A=t||"div";return a.jsx(A,{role:"row","aria-rowindex":n+1+(g?0:1),"aria-selected":v,tabIndex:-1,className:E(s,P),item:A==="div"?void 0:e,onDoubleClick:oe(k),onKeyDown:oe(b),onContextMenu:oe(D),onPointerEnter:oe(()=>x(!0)),onPointerLeave:oe(()=>x(!1)),style:r,...z,children:l.map((S,R)=>a.jsx(Hs,{rowIndex:n,rowIsHovered:y,index:R,item:e},`${e.id}-${S.key}`))})}const Ws={key:"checkbox",header:()=>a.jsx(Gs,{}),align:"center",width:"w-24 flex-shrink-0",body:(e,n)=>n.isPlaceholder?a.jsx(ie,{size:"w-24 h-24",variant:"rect"}):a.jsx(Ys,{item:e})};function Ys({item:e}){const{selectedRows:n,toggleRow:t}=h.useContext(Z);return a.jsx(Lt,{checked:n.includes(e.id),onChange:()=>t(e)})}function Gs(){const{trans:e}=U(),{data:n,selectedRows:t,onSelectionChange:s}=h.useContext(Z),r=!!n.length&&n.length===t.length,o=!r&&!!t.length;return a.jsx(Lt,{"aria-label":e({message:"Select all"}),isIndeterminate:o,checked:r,onChange:()=>{s(r?[]:n.map(l=>l.id))}})}const Xs=K(a.jsx("path",{d:"m20 12-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"}),"ArrowDownwardOutlined");function Qs({index:e}){const{columns:n,sortDescriptor:t,onSortChange:s,enableSorting:r}=h.useContext(Z),o=n[e],l=on({index:e,isHeader:!0}),[i,c]=h.useState(!1),d=o.sortingKey||o.key,u=o.allowsSorting&&r,{orderBy:f,orderDir:m}=t||{},g=u&&f===d;let p;g&&m==="asc"?p="ascending":g&&m==="desc"?p="descending":u&&(p="none");const v=()=>{if(!u)return;let w;g&&m==="desc"?w={orderDir:"asc",orderBy:d}:g&&m==="asc"?w={orderBy:void 0,orderDir:void 0}:w={orderDir:"desc",orderBy:d},s==null||s(w)},y=g||i,x={visible:{opacity:1,y:0},hidden:{opacity:0,y:"-25%"}};return a.jsxs("div",{role:"columnheader",tabIndex:-1,"aria-colindex":e+1,"aria-sort":p,className:E(l,"text-muted font-medium text-xs",u&&"cursor-pointer"),onMouseEnter:()=>{c(!0)},onMouseLeave:()=>{c(!1)},onKeyDown:w=>{(w.key===" "||w.key==="Enter")&&(w.preventDefault(),v())},onClick:v,children:[o.hideHeader?a.jsx("div",{className:"sr-only",children:o.header()}):o.header(),a.jsx(Le,{children:u&&a.jsx(ge.span,{variants:x,animate:y?"visible":"hidden",initial:!1,transition:{type:"tween"},className:"inline-block ml-6 -mt-2","data-testid":"table-sort-button","aria-hidden":!y,children:a.jsx(Xs,{size:"xs",className:E("text-muted",m==="asc"&&f===d&&"rotate-180 transition-transform")})},"sort-icon")})]})}function Zs(){const{columns:e}=h.useContext(Z);return a.jsx("div",{role:"row","aria-rowindex":1,tabIndex:-1,className:"flex gap-x-16 px-16",children:e.map((n,t)=>a.jsx(Qs,{index:t},n.key))})}function Ca({className:e,columns:n,collapseOnMobile:t=!0,hideHeaderRow:s=!1,hideBorder:r=!1,data:o,selectedRows:l,defaultSelectedRows:i,onSelectionChange:c,sortDescriptor:d,onSortChange:u,enableSorting:f=!0,onDelete:m,enableSelection:g=!0,selectionStyle:p="checkbox",ariaLabelledBy:v,selectRowOnContextMenu:y,onAction:x,renderRowAs:w,tableBody:k,meta:I,tableRef:N,closeOnInteractOutside:z=!1,cellHeight:b,headerCellHeight:D,...P}){const A=me(),S=!!A&&t;S&&(s=!0,r=!0);const[R,L]=ue(l,i||[],c),[Y,_]=ue(d,void 0,u),j=h.useCallback($=>{const V=[...R];if(!V.includes($.id))V.push($.id);else{const re=V.indexOf($.id);V.splice(re,1)}L(V)},[R,L]),T=h.useCallback(($,V)=>{let re=[];$&&(re=V?[...R==null?void 0:R.filter(ae=>ae!==$.id),$.id]:[$.id]),L(re)},[R,L]),F=h.useMemo(()=>{const $=n.filter(re=>{const ae=re.visibleInMode||"regular";if(ae==="all"||ae==="compact"&&S||ae==="regular"&&!S)return!0});return g&&p!=="highlight"&&!A&&$.unshift(Ws),$},[A,n,g,p,S]),H={isCollapsedMode:S,cellHeight:b,headerCellHeight:D,hideBorder:r,hideHeaderRow:s,selectedRows:R,onSelectionChange:L,enableSorting:f,enableSelection:g,selectionStyle:p,data:o,columns:F,sortDescriptor:Y,onSortChange:_,toggleRow:j,selectRow:T,onAction:x,selectRowOnContextMenu:y,meta:I,collapseOnMobile:t},G=Vs({cellCount:g?F.length+1:F.length,rowCount:o.length+1}),Te={renderRowAs:w};k?k=h.cloneElement(k,Te):k=a.jsx(Js,{...Te});const xe=$e(N);return Bn({ref:xe,onInteractOutside:$=>{z&&g&&(R!=null&&R.length)&&!$.target.closest('[role="dialog"]')&&L([])}}),a.jsx(Z.Provider,{value:H,children:a.jsxs("div",{...ne(P,G,{onKeyDown:$=>{$.key==="Escape"?($.preventDefault(),$.stopPropagation(),R!=null&&R.length&&L([])):$.key==="Delete"?($.preventDefault(),$.stopPropagation(),R!=null&&R.length&&(m==null||m(o.filter(V=>R==null?void 0:R.includes(V.id))))):Fe($)&&$.key==="a"&&($.preventDefault(),$.stopPropagation(),g&&L(o.map(V=>V.id)))}}),role:"grid",tabIndex:0,"aria-rowcount":o.length+1,"aria-colcount":F.length+1,ref:xe,"aria-multiselectable":g?!0:void 0,"aria-labelledby":v,className:E(e,"isolate select-none text-sm outline-none focus-visible:ring-2"),children:[!s&&a.jsx(Zs,{}),k]})})}function Js({renderRowAs:e}){const{data:n}=h.useContext(Z);return a.jsx(h.Fragment,{children:n.map((t,s)=>a.jsx(qs,{item:t,index:s,renderAs:e},t.id))})}function er({isLoading:e,icon:n}){const t=h.useRef(null),{trans:s}=U(),[r,o]=h.useState(!1),{state:{isOpen:l,inputValue:i}}=Kn(),c=h.useRef(i);return h.useEffect(()=>{e&&!r?(t.current===null&&(t.current=setTimeout(()=>{o(!0)},500)),i!==c.current&&(clearTimeout(t.current),t.current=setTimeout(()=>{o(!0)},500))):e||(o(!1),clearTimeout(t.current),t.current=null),c.current=i},[e,r,i]),r&&(l||e)?a.jsx(He,{"aria-label":s({message:"Loading"}),size:"sm",isIndeterminate:!0}):n||a.jsx(Be,{})}function tr(e,n){const t=me(),{hideCaret:s,placeholder:r=a.jsx(O,{message:"Select an option..."}),selectedValue:o,onItemSelected:l,onOpenChange:i,onInputValueChange:c,onSelectionChange:d,selectionMode:u,minWidth:f="min-w-128",children:m,searchPlaceholder:g,showEmptyMessage:p,showSearchField:v,defaultInputValue:y,inputValue:x,isLoading:w,isAsync:k,valueClassName:I,floatingWidth:N=t?"auto":"matchTrigger",...z}=e,b=Ht({...e,clearInputOnItemSelection:!0,showEmptyMessage:p||v,floatingWidth:N,selectionMode:"single",role:"listbox",virtualFocus:v},n),{state:{selectedValues:D,isOpen:P,setIsOpen:A,activeIndex:S,setSelectedIndex:R,inputValue:L,setInputValue:Y},collections:_,focusItem:j,listboxId:T,reference:F,refs:H,listContent:G,onInputChange:Te}=b,{fieldProps:xe,inputProps:$}=at({...z,focusRef:H.reference}),V=_.collection.get(D[0]),re=V?a.jsxs("span",{className:"flex items-center gap-10",children:[V.element.props.startIcon,a.jsx("span",{className:E("overflow-hidden overflow-ellipsis whitespace-nowrap",I),children:V.element.props.children})]}):a.jsx("span",{className:"italic",children:r}),ae=Pe({...e,endAdornment:!0}),{handleTriggerKeyDown:xn,handleListboxKeyboardNavigation:vn,handleListboxSearchFieldKeydown:bn}=Kt(b),{findMatchingItem:xt}=Un(),yn=ve=>{if(!P)return;const be=xt(ve,G,S);be!=null&&j("increment",be)},wn=ve=>{if(P)return;const be=xt(ve,G,S);be!=null&&R(be)};return a.jsx(Bt,{listbox:b,onKeyDownCapture:v?void 0:yn,onKeyDown:vn,onClose:v?()=>Y(""):void 0,isLoading:w,searchField:v&&a.jsx(_n,{size:e.size==="xs"||e.size==="sm"?"xs":"sm",placeholder:g,startAdornment:a.jsx(qn,{}),className:"flex-shrink-0 px-8 pb-8 pt-4",autoFocus:!0,"aria-expanded":P?"true":"false","aria-haspopup":"listbox","aria-controls":P?T:void 0,"aria-autocomplete":"list",autoComplete:"off",autoCorrect:"off",spellCheck:"false",value:L,onChange:Te,onKeyDown:ve=>{bn(ve)}}),children:a.jsx(ot,{fieldClassNames:ae,...xe,endAdornment:!s&&a.jsx(er,{isLoading:w}),children:a.jsx("button",{...$,type:"button","data-selected-value":V==null?void 0:V.value,"aria-expanded":P?"true":"false","aria-haspopup":"listbox","aria-controls":P?T:void 0,ref:F,onKeyDown:xn,onKeyDownCapture:v?void 0:wn,disabled:z.disabled,onClick:()=>{A(!P)},className:E(ae.input,!xe.unstyled&&f),children:re})})})}const ln=fe.forwardRef(tr);function cn({children:e,...n}){const{field:{onChange:t,onBlur:s,value:r=null,ref:o},fieldState:{invalid:l,error:i}}=pe({name:n.name}),c={onSelectionChange:t,onBlur:s,selectedValue:r,invalid:l,errorMessage:i==null?void 0:i.message,name:n.name},d=n.errorMessage||(i==null?void 0:i.message);return a.jsx(ln,{ref:o,...ne(c,n,{errorMessage:d}),children:e})}const Ia=K(a.jsx("path",{d:"m7 10 5 5 5-5H7z"}),"ArrowDropDownOutlined");function nr({filter:e}){const{trans:n}=U();return a.jsx(cn,{size:"sm",name:`${e.key}.value`,selectionMode:"single",showSearchField:e.control.showSearchField,placeholder:e.control.placeholder?n(e.control.placeholder):void 0,searchPlaceholder:e.control.searchPlaceholder?n(e.control.searchPlaceholder):void 0,children:e.control.options.map(t=>a.jsx(Ke,{value:t.key,children:a.jsx(O,{...t.label})},t.key))})}function sr({filter:e}){return a.jsx(Rs,{min:e.control.min,max:e.control.max,size:"sm",name:`${e.key}.value`,granularity:"day",closeDialogOnSelection:!0})}const _e=h.forwardRef(({className:e,circle:n,size:t="md",src:s,link:r,label:o,fallback:l="generic",lazy:i=!0,...c},d)=>{let u=s?a.jsx("img",{ref:d,src:s,alt:o,loading:i?"lazy":void 0,className:"block h-full w-full object-cover"}):a.jsx("div",{className:"h-full w-full bg-alt dark:bg-chip",children:a.jsx(Yn,{viewBox:"0 0 48 48",className:"h-full w-full text-muted"})});o&&(u=a.jsx(Ut,{label:o,children:u}));const f={...c,className:E(e,"relative block overflow-hidden select-none flex-shrink-0",rr(t),n?"rounded-full":"rounded")};return r?a.jsx(Wn,{...f,to:r,children:u}):a.jsx("div",{...f,children:u})});function rr(e){switch(e){case"xs":return"w-18 h-18";case"sm":return"w-24 h-24";case"md":return"w-32 h-32";case"lg":return"w-40 h-40";case"xl":return"w-60 h-60";default:return e}}function ar(e,n,t){return _t({queryKey:[e,n],queryFn:()=>or(e,n),placeholderData:Gn,...t})}async function or(e,n){return Ue.get(e,{params:n}).then(t=>t.data)}function un(e,n,t){return _t({queryKey:[e,n],queryFn:()=>lr(e,n),...t})}async function lr(e,n){return Ue.get(e,{params:n}).then(t=>t.data)}function ir({label:e,className:n,background:t,value:s,defaultValue:r="",placeholder:o=C("Select item..."),searchPlaceholder:l=C("Find an item..."),onChange:i,description:c,errorMessage:d,invalid:u,autoFocus:f,queryParams:m,endpoint:g,disabled:p,required:v}){var D;const y=h.useRef(null),[x,w]=h.useState(""),[k,I]=ue(s,r,i),N=ar(g,{query:x,...m}),{trans:z}=U(),b=Pe({size:"md"});return k?a.jsxs("div",{className:n,children:[a.jsx("div",{className:b.label,children:e}),a.jsx("div",{className:E("rounded-input border p-8",t,u&&"border-danger"),children:a.jsx(Le,{initial:!1,mode:"wait",children:a.jsx(cr,{disabled:p,endpoint:g,modelId:k,queryParams:m,onEditClick:()=>{I(""),w(""),requestAnimationFrame(()=>{var P,A;(P=y.current)==null||P.focus(),(A=y.current)==null||A.click()})}})})}),c&&!d&&a.jsx("div",{className:b.description,children:c}),d&&a.jsx("div",{className:b.error,children:d})]}):a.jsx(ln,{className:n,showSearchField:!0,invalid:u,errorMessage:d,description:c,color:"white",isAsync:!0,background:t,placeholder:z(o),searchPlaceholder:z(l),label:e,isLoading:N.isFetching,items:(D=N.data)==null?void 0:D.results,inputValue:x,onInputValueChange:w,selectionMode:"single",selectedValue:k,onSelectionChange:I,ref:y,autoFocus:f,disabled:p,required:v,children:P=>a.jsx(Ke,{value:P.id,description:P.description,startIcon:a.jsx(_e,{src:P.image}),children:P.name},P.id)})}function cr({modelId:e,onEditClick:n,endpoint:t,disabled:s,queryParams:r}){const{data:o,isLoading:l}=un(`${t}/${e}`,r);return l||!(o!=null&&o.model)?a.jsx(ur,{},"skeleton"):a.jsxs(ge.div,{className:E("flex items-center gap-10",s&&"pointer-events-none cursor-not-allowed text-disabled"),...ft,children:[o.model.image&&a.jsx(_e,{src:o.model.image}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm leading-4",children:o.model.name}),a.jsx("div",{className:"text-xs text-muted",children:o.model.description})]}),a.jsx(Ut,{label:a.jsx(O,{message:"Change item"}),children:a.jsx(Q,{className:"ml-auto text-muted",size:"sm",onClick:n,disabled:s,children:a.jsx(is,{})})})]},"preview")}function ur(){return a.jsxs(ge.div,{className:"flex items-center gap-10",...ft,children:[a.jsx(ie,{variant:"rect",size:"w-32 h-32"}),a.jsxs("div",{className:"max-h-[36px] flex-auto",children:[a.jsx(ie,{className:"text-xs"}),a.jsx(ie,{className:"max-h-8 text-xs"})]}),a.jsx(ie,{variant:"icon",size:"w-24 h-24"})]})}function dr({name:e,...n}){const{clearErrors:t}=Xn(),{field:{onChange:s,value:r=""},fieldState:{invalid:o,error:l}}=pe({name:e});return a.jsx(ir,{value:r,onChange:i=>{s(i),t(e)},invalid:o,errorMessage:l==null?void 0:l.message,...n})}function fr({filter:e}){return a.jsx(dr,{name:`${e.key}.value`,endpoint:`normalized-models/${e.control.model}`})}const dn={"=":C("is"),"!=":C("is not"),">":C("is greater than"),">=":C("is greater than or equal to"),"<":C("is less than"),"<=":C("is less than or equal to"),has:C("Include"),doesntHave:C("Do not include"),between:C("Is between"),hasAll:C("Include all")};function hr({filter:e}){var t;const n=e.control;return a.jsxs(h.Fragment,{children:[a.jsx(cn,{selectionMode:"single",name:`${e.key}.operator`,className:"mb-14",size:"sm",required:!0,children:(t=e.operators)==null?void 0:t.map(s=>a.jsx(Ke,{value:s,children:a.jsx(O,{...dn[s]})},s))}),a.jsx(Qn,{size:"sm",name:`${e.key}.value`,type:e.control.inputType,min:"minValue"in n?n.minValue:void 0,max:"maxValue"in n?n.maxValue:void 0,minLength:"minLength"in n?n.minLength:void 0,maxLength:"maxLength"in n?n.maxLength:void 0,required:!0})]})}function mr({className:e,children:n,size:t,color:s,radius:r,selectable:o,wrap:l=!0}){return a.jsx("div",{className:E("flex items-center gap-8",l&&"flex-wrap",e),children:h.Children.map(n,i=>{if(h.isValidElement(i))return h.cloneElement(i,{size:t,color:s,selectable:o,radius:r})})})}function st(e){return{id:e,name:`${e}`,description:`${e}`}}function gr(e,n){const t=h.useRef(null),s=$e(n),{displayWith:r=H=>H.name,validateWith:o,children:l,suggestions:i,isLoading:c,inputValue:d,onInputValueChange:u,onItemSelected:f,placeholder:m,onOpenChange:g,chipSize:p="sm",openMenuOnFocus:v=!0,showEmptyMessage:y,value:x,defaultValue:w,onChange:k,valueKey:I,isAsync:N,allowCustomValue:z=!0,showDropdownArrow:b,onChipClick:D,...P}=e,A=Pe({...e,flexibleHeight:!0}),[S,R]=vr(e),[L,Y]=h.useState(!1),_=a.jsx(He,{isIndeterminate:!0,size:"sm","aria-label":"loading..."}),j=b?a.jsx(Be,{}):null,{fieldProps:T,inputProps:F}=at({...P,focusRef:s,endAdornment:c&&L?_:j});return a.jsx(ot,{fieldClassNames:A,...T,children:a.jsxs(Xt,{ref:t,className:E("flex flex-wrap items-center",A.input),onClick:()=>{var H;(H=s.current)==null||H.focus()},children:[a.jsx(pr,{displayChipUsing:r,onChipClick:D,items:S,setItems:R,chipSize:p}),a.jsx(xr,{showEmptyMessage:y,inputProps:F,inputValue:d,onInputValueChange:u,fieldRef:t,inputRef:s,chips:S,setChips:R,validateWith:o,isLoading:c,suggestions:i,placeholder:m,openMenuOnFocus:v,listboxIsOpen:L,setListboxIsOpen:Y,allowCustomValue:z,children:l})]})})}function pr({items:e,setItems:n,displayChipUsing:t,chipSize:s,onChipClick:r}){const o=Me(),l=h.useCallback(i=>{const c=e.findIndex(u=>u.id===i),d=[...e];return c>-1&&(d.splice(c,1),n(d)),d},[e,n]);return a.jsx(mr,{className:"my-8 max-w-full flex-shrink-0 flex-wrap",size:s,selectable:!0,children:e.map(i=>a.jsx(Zn,{errorMessage:i.errorMessage,adornment:i.image?a.jsx(_e,{circle:!0,src:i.image}):null,onClick:()=>r==null?void 0:r(i),onRemove:()=>{l(i.id).length?o==null||o.focusPrevious({tabbable:!0}):o==null||o.focusLast()},children:t(i)},i.id))})}function xr(e){const{inputRef:n,fieldRef:t,validateWith:s,setChips:r,chips:o,suggestions:l,inputProps:i,placeholder:c,openMenuOnFocus:d,listboxIsOpen:u,setListboxIsOpen:f,allowCustomValue:m,isLoading:g}=e,p="outline-none text-sm mx-8 my-4 h-30 flex-auto",v=Me(),y=h.useCallback(j=>{j=(j||[]).filter(T=>{const F=!T||!T.id||!T.name;return!(o.findIndex(G=>G.id===(T==null?void 0:T.id))>-1)&&!F}),j.length&&(s&&(j=j.map(T=>s(T))),r([...o,...j]))},[o,r,s]),x=Ht({...e,clearInputOnItemSelection:!0,isOpen:u,onOpenChange:f,items:l,selectionMode:"none",role:"listbox",virtualFocus:!0,onItemSelected:j=>{R(j)}}),{state:{activeIndex:w,setActiveIndex:k,isOpen:I,setIsOpen:N,inputValue:z,setInputValue:b},refs:D,listboxId:P,collection:A,onInputChange:S}=x,R=j=>{const T=A.size&&w!=null?[...A.values()][w]:null;T!=null&&T.item?y([T.item]):m&&y([st(T?T.value:j)]),b(""),k(null),N(!1)};Jn(()=>{t.current&&D.reference.current!==t.current&&x.reference(t.current)},[t,x,D]);const{handleTriggerKeyDown:L,handleListboxKeyboardNavigation:Y}=Kt(x),_=oe(()=>{d&&!I&&N(!0)});return a.jsx(Bt,{listbox:x,mobileOverlay:es,isLoading:g,onPointerDown:j=>{j.preventDefault()},children:a.jsx("input",{type:"text",className:E(p,"bg-transparent"),placeholder:c,...ne(i,{ref:n,value:z,onChange:S,onPaste:j=>{const F=j.clipboardData.getData("text").match(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi);if(F){j.preventDefault();const H=window.getSelection();H!=null&&H.rangeCount&&(H.deleteFromDocument(),y(F.map(G=>st(G))))}},"aria-autocomplete":"list","aria-controls":I?P:void 0,autoComplete:"off",autoCorrect:"off",spellCheck:"false",onKeyDown:j=>{const T=j.target;if(j.key==="Enter"){j.preventDefault(),R(T.value);return}if(j.key==="Escape"&&I&&(N(!1),b("")),j.key==="ArrowUp"&&I&&(w===0||w==null)){k(null);return}if(w!=null&&(j.key==="ArrowLeft"||j.key==="ArrowRight")){j.preventDefault();return}if((j.key==="ArrowLeft"||j.key==="Backspace"||j.key==="Delete")&&T.selectionStart===0&&w==null&&o.length){v==null||v.focusPrevious({tabbable:!0});return}L(j)||Y(j)},onFocus:_,onClick:_})})})}function vr({onChange:e,value:n,defaultValue:t,valueKey:s}){const r=h.useMemo(()=>Ct(n),[n]),o=h.useMemo(()=>Ct(t),[t]),l=h.useCallback(i=>{const c=s?i.map(d=>d[s]):i;e==null||e(c)},[e,s]);return ue(r||void 0,o||[],l)}function Ct(e){if(e!=null)return e.map(n=>typeof n!="object"?st(n):n)}const br=fe.forwardRef(gr);function yr({children:e,...n}){const{field:{onChange:t,onBlur:s,value:r=[],ref:o},fieldState:{invalid:l,error:i}}=pe({name:n.name}),c={onChange:t,onBlur:s,value:r,invalid:l,errorMessage:i==null?void 0:i.message};return a.jsx(br,{ref:o,...ne(c,n),children:e})}function wr({filter:e}){const{trans:n}=U();return a.jsx(yr,{size:"sm",name:`${e.key}.value`,valueKey:"id",allowCustomValue:!1,showDropdownArrow:!0,placeholder:e.control.placeholder?n(e.control.placeholder):void 0,displayWith:t=>{var s;return(s=e.control.options.find(r=>r.key===t.id))==null?void 0:s.label.message},suggestions:e.control.options.map(t=>({id:t.key,name:t.label.message})),children:t=>a.jsx(Ke,{value:t.id,children:a.jsx(O,{message:t.name})},t.id)})}const fn=h.forwardRef((e,n)=>{const{isInactive:t,filter:s,...r}=e;return t?a.jsx(jr,{filter:s,...r,ref:n}):a.jsx(kr,{filter:s,...r,ref:n})}),jr=h.forwardRef(({filter:e,...n},t)=>a.jsx(ee,{variant:"outline",size:"xs",color:"paper",radius:"rounded-md",border:"border",ref:t,endIcon:a.jsx(Be,{}),...n,children:a.jsx(O,{...e.label})})),kr=h.forwardRef(({filter:e,children:n,...t},s)=>{const r=e.control.type===B.BooleanToggle;return a.jsxs(ee,{variant:"outline",size:"xs",color:"primary",radius:"rounded-r-md",border:"border-y border-r",endIcon:!r&&a.jsx(Be,{}),ref:s,...t,children:[a.jsx("span",{className:E(!r&&"border-r border-r-primary-light mr-8 pr-8"),children:a.jsx(O,{...e.label})}),n]})});function Se(e){const{onValueChange:n,isInactive:t,filter:s,label:r}=e;return a.jsxs(dt,{offset:10,type:"popover",onClose:o=>{o!==void 0&&n(o)},children:[a.jsx(fn,{isInactive:t,filter:s,children:r}),a.jsx(Cr,{...e})]})}function Cr({filter:e,panel:n,value:t,operator:s}){const r=ts({defaultValues:{[e.key]:{value:t,operator:s}}}),{close:o,formId:l}=it();return a.jsxs(Ve,{size:"xs",children:[a.jsx(ns,{children:a.jsx(O,{...e.label})}),a.jsx(ut,{padding:"px-14 pt-14 pb-4 max-h-288",children:a.jsxs(ss,{form:r,id:l,onSubmit:i=>{o(i[e.key])},children:[e.description&&a.jsx("div",{className:"text-muted text-xs mb-14",children:a.jsx(O,{...e.description})}),n]})}),a.jsx(ct,{children:a.jsx(ee,{form:l,type:"submit",variant:"flat",color:"primary",size:"xs",children:a.jsx(O,{message:"Apply"})})})]})}const Ir=h.memo(({value:e,...n})=>{const t=rs(n);return isNaN(e)&&(e=0),a.jsx(h.Fragment,{children:t.format(e)})},zt);function Dr(e){switch(e.filter.control.type){case B.DateRangePicker:return a.jsx(Pr,{...e});case B.BooleanToggle:return a.jsx(Sr,{...e});case B.Select:return a.jsx(Tr,{...e});case B.ChipField:return a.jsx(Er,{...e});case B.Input:return a.jsx(Nr,{...e});case B.SelectModel:return a.jsx(Fr,{...e});case B.Custom:const n=e.filter.control.listItem;return a.jsx(n,{...e});default:return null}}function Pr(e){const{value:n,filter:t}=e;let s;return n.preset!==void 0?s=a.jsx(O,{...ht[n.preset].label}):s=a.jsx(nn,{start:new Date(n.start),end:new Date(n.end),options:{dateStyle:"medium"}}),a.jsx(Se,{...e,label:s,panel:a.jsx(sr,{filter:t})})}function Sr({filter:e,isInactive:n,onValueChange:t}){return a.jsx(fn,{onClick:()=>{t({value:e.control.defaultValue})},filter:e,isInactive:n})}function Tr(e){const{filter:n,value:t}=e,s=n.control.options.find(r=>r.key===t);return a.jsx(Se,{...e,label:s?a.jsx(O,{...s.label}):null,panel:a.jsx(nr,{filter:n})})}function Er(e){return a.jsx(Se,{...e,label:a.jsx(Rr,{...e}),panel:a.jsx(wr,{filter:e.filter})})}function Rr(e){const{trans:n}=U(),{filter:t,value:s}=e,r=s.map(c=>t.control.options.find(d=>d.key===c)),o=3,l=s.length-o,i=a.jsx(h.Fragment,{children:r.filter(Boolean).slice(0,o).map((c,d)=>{let u="";return d!==0&&(u+=", "),u+=n(c.label),u})});return l>0?a.jsx(O,{message:":names + :count more",values:{names:i,count:l}}):i}function Nr(e){const{filter:n,value:t,operator:s}=e,r=s?a.jsx(O,{...dn[s]}):null,o=n.control.inputType==="number"?a.jsx(Ir,{value:t}):t;return a.jsx(Se,{...e,label:a.jsxs(h.Fragment,{children:[r," ",o]}),panel:a.jsx(hr,{filter:n})})}function Fr(e){const{value:n,filter:t}=e,{isLoading:s,data:r}=un(`normalized-models/${t.control.model}/${n}`,void 0,{enabled:!!n}),o=a.jsxs(h.Fragment,{children:[a.jsx(ie,{variant:"avatar",size:"w-18 h-18 mr-6"}),a.jsx(ie,{variant:"rect",size:"w-50"})]}),l=a.jsxs(h.Fragment,{children:[a.jsx(_e,{size:"xs",src:r==null?void 0:r.model.image,className:"mr-6"}),r==null?void 0:r.model.name]}),i=s||!r?o:l;return a.jsx(Se,{...e,label:i,panel:a.jsx(fr,{filter:t})})}function Da({filters:e,pinnedFilters:n,className:t}){const{decodedFilters:s,remove:r,replaceAll:o}=Ms(e,n);return s.length?a.jsx("div",{className:E("flex items-center gap-6 overflow-x-auto",t),children:s.map((l,i)=>{const c=e.find(u=>u.key===l.key);if(!c)return null;const d=u=>{const f=[...s];f.splice(i,1,{key:c.key,value:u.value,isInactive:!1,operator:u.operator||c.defaultOperator}),o(f)};return a.jsxs("div",{children:[!l.isInactive&&a.jsx(Q,{variant:"outline",color:"primary",size:"xs",radius:"rounded-l-md",onClick:()=>{r(l.key)},children:a.jsx(qt,{})}),a.jsx(Dr,{filter:c,isInactive:l.isInactive,value:l.valueKey!=null?l.valueKey:l.value,operator:l.operator,onValueChange:d})]},l.key)})}):null}const It=K(a.jsx("path",{d:"M18 15v3H6v-3H4v3c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-3h-2zm-1-4-1.41-1.41L13 12.17V4h-2v8.17L8.41 9.59 7 11l5 5 5-5z"}),"FileDownloadOutlined");function rt(e,n){const t=document.createElement("a");t.href=e,n&&(t.download=n),document.body.appendChild(t),t.click(),document.body.removeChild(t)}function zr(e){const n=gt(),[t,s]=h.useState(!e.value&&!e.defaultValue),r=e.onChange,[o,l]=ue(e.value||n,e.defaultValue||n,I=>{s(!1),r==null||r(I)}),{min:i,max:c,granularity:d,timezone:u,calendarIsOpen:f,setCalendarIsOpen:m,closeDialogOnSelection:g}=Qt(o,e),p=h.useCallback(()=>{s(!0),l(n),r==null||r(null),m(!1)},[n,l,r,m]),[v,y]=h.useState(()=>[Ce(o)]),x=h.useCallback(I=>{i&&I.compare(i)<0?I=i:c&&I.compare(c)>0&&(I=c);const N=o?o.set(I):ce(I,u);l(N),y([Ce(N)]),s(!1)},[l,i,c,o,u]),w=h.useCallback(I=>!t&&we(o,I),[o,t]),k=h.useCallback(I=>({onClick:()=>{x==null||x(I),g&&(m==null||m(!1))}}),[x,m,g]);return{selectedValue:o,setSelectedValue:l,calendarIsOpen:f,setCalendarIsOpen:m,dayIsActive:w,dayIsHighlighted:()=>!1,dayIsRangeStart:()=>!1,dayIsRangeEnd:()=>!1,getCellProps:k,calendarDates:v,setCalendarDates:y,isPlaceholder:t,clear:p,setIsPlaceholder:s,min:i,max:c,granularity:d,timezone:u,closeDialogOnSelection:g}}function Or({showCalendarFooter:e,...n}){const t=zr(n),s=h.useRef(null),r=gt(),o=e&&a.jsx(ct,{padding:"px-14 pb-14",startAction:a.jsx(ee,{disabled:t.isPlaceholder,variant:"text",color:"primary",onClick:()=>{t.clear()},children:a.jsx(O,{message:"Clear"})}),children:a.jsx(ee,{variant:"text",color:"primary",onClick:()=>{t.setSelectedValue(r),t.setCalendarIsOpen(!1)},children:a.jsx(O,{message:"Today"})})}),l=a.jsx(dt,{offset:8,placement:"bottom-start",isOpen:t.calendarIsOpen,onOpenChange:t.setCalendarIsOpen,type:"popover",triggerRef:s,returnFocusToTrigger:!1,moveFocusToDialog:!1,children:a.jsxs(Ve,{size:"auto",children:[a.jsx(ut,{className:"flex items-start gap-40",padding:e?"px-24 pt-20 pb-10":null,children:a.jsx(tn,{state:t,visibleMonths:1})}),o]})}),i={onClick:c=>{c.stopPropagation(),c.preventDefault(),$r(c)?t.setCalendarIsOpen(!1):t.setCalendarIsOpen(!0)}};return a.jsxs(h.Fragment,{children:[a.jsx(mt,{ref:s,wrapperProps:i,endAdornment:a.jsx(Gt,{className:E(n.disabled&&"text-disabled")}),...n,children:a.jsx(De,{segmentProps:i,state:t,value:t.selectedValue,onChange:t.setSelectedValue,isPlaceholder:t.isPlaceholder})}),l]})}function Pa(e){const{min:n,max:t}=e,{trans:s}=U(),{format:r}=de(),{field:{onChange:o,onBlur:l,value:i=null,ref:c},fieldState:{invalid:d,error:u}}=pe({name:e.name,rules:{validate:g=>{if(!g)return;const p=Ne(g);if(n&&p.compare(n)<0)return s({message:"Enter a date after :date",values:{date:r(g)}});if(t&&p.compare(t)>0)return s({message:"Enter a date before :date",values:{date:r(g)}})}}}),f=i?Ne(i):null,m={onChange:g=>{o(g&&g.toAbsoluteString())},onBlur:l,value:f,invalid:d,errorMessage:u==null?void 0:u.message,inputRef:c};return a.jsx(Or,{...ne(m,e)})}function $r(e){return["hour","minute","dayPeriod"].includes(e.currentTarget.ariaLabel||"")}const Sa=K(a.jsx("path",{d:"M16 9v10H8V9h8m-1.5-6h-5l-1 1H5v2h14V4h-3.5l-1-1zM18 7H6v12c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7z"}),"DeleteOutlined"),J=new Map,Ee=new Map,Ar=new Map,W={status:"inactive"};function Ze({e,rect:n,deltaX:t,deltaY:s}){return{rect:n,x:e.clientX,y:e.clientY,deltaX:t??0,deltaY:s??0,nativeEvent:e}}let hn=null;function Dt(e){hn=e}function Mr(e){return{left:e.left,top:e.top,width:e.width,height:e.height}}function Vr(e){const n=new IntersectionObserver(t=>{t.forEach(s=>{const{width:r,height:o,left:l,top:i}=s.boundingClientRect,[c,d]=[...e].find(([,f])=>f.ref.current===s.target)||[];if(c==null||d==null)return;const u={width:r,height:o,left:l,top:i};e.set(c,{...d,rect:u})}),n.disconnect()});[...e.values()].forEach(t=>{t.ref.current&&n.observe(t.ref.current)})}function Ta({id:e,disabled:n,ref:t,preview:s,hidePreview:r,...o}){const l=h.useRef(null),{addGlobalListener:i,removeAllGlobalListeners:c}=Vt(),d=h.useRef({lastPosition:{x:0,y:0}}).current,u=h.useRef(o);u.current=o,h.useLayoutEffect(()=>(n?J.delete(e):J.set(e,{...J.get(e),id:e,ref:t,type:u.current.type,getData:u.current.getData}),()=>{J.delete(e)}),[e,n,u,t]);const f=y=>{Ar.forEach(x=>{var w;x.type===((w=J.get(e))==null?void 0:w.type)&&y(x)})},m=y=>{var N,z;const x=J.get(e),w=t.current,k=!l.current||!d.clickedEl||l.current.contains(d.clickedEl);if(hn||!w||!x||!k){y.preventDefault(),y.stopPropagation();return}Vr(Ee),Dt("drag"),r&&Lr(y),y.dataTransfer.effectAllowed="move",d.lastPosition={x:y.clientX,y:y.clientY},d.currentRect=Mr(w.getBoundingClientRect());const I=Ze({rect:d.currentRect,e:y});s!=null&&s.current&&s.current(x,b=>{y.dataTransfer.setDragImage(b,0,0)}),W.status="dragging",W.dragTargetId=e,t.current&&(t.current.dataset.dragging="true"),(z=(N=u.current).onDragStart)==null||z.call(N,I,x),requestAnimationFrame(()=>{f(b=>{var D;return(D=b.onDragStart)==null?void 0:D.call(b,I,x)})}),i(window,"dragover",g,!0)},g=y=>{var z,b;if(y.preventDefault(),!d.currentRect)return;const x=y.clientX-d.lastPosition.x,w=y.clientY-d.lastPosition.y,k={...d.currentRect,left:d.currentRect.left+x,top:d.currentRect.top+w},I=Ze({rect:k,e:y,deltaX:x,deltaY:w}),N=J.get(e);N&&((b=(z=u.current).onDragMove)==null||b.call(z,I,N),f(D=>{var P;return(P=D.onDragMove)==null?void 0:P.call(D,I,N)})),d.lastPosition={x:y.clientX,y:y.clientY},d.currentRect=k};return{draggableProps:{draggable:!n,onDragStart:m,onDragEnd:y=>{var k,I;if(c(),!d.currentRect)return;Dt(null),le&&le.remove();const x=Ze({rect:d.currentRect,e:y}),w=J.get(e);w&&((I=(k=u.current).onDragEnd)==null||I.call(k,x,w),f(N=>{var z;return(z=N.onDragEnd)==null?void 0:z.call(N,x,w,W.status)})),requestAnimationFrame(()=>{W.dragTargetId=void 0,W.status="inactive",t.current&&delete t.current.dataset.dragging})},onPointerDown:y=>{d.clickedEl=y.target}},dragHandleRef:l}}let le;function Lr(e){le||(le=new Image,document.body.append(le),le.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="),e.dataTransfer.setDragImage(le,0,0)}async function*Hr(e){const n=[];for(const t of e.items)if(t.kind==="file"){const s=t.webkitGetAsEntry();s&&n.push(s)}for(const t of n)if(t.isFile){if(t.name===".DS_Store")continue;const s=await gn(t);yield new Wt(s,t.fullPath)}else t.isDirectory&&(yield*mn(t))}async function*mn(e){const n=e.createReader();let t;do{t=await new Promise((s,r)=>{n.readEntries(s,r)});for(const s of t)if(s.isFile){if(s.name===".DS_Store")continue;const r=await gn(s);yield new Wt(r,s.fullPath)}else s.isDirectory&&(yield*mn(s))}while(t.length>0)}function gn(e){return new Promise((n,t)=>e.file(n,t))}async function Br(e){const n=[];for await(const t of e)n.push(t);return n}const Kr=400;function Ea({id:e,disabled:n,ref:t,...s}){const r=h.useRef({dragOverElements:new Set,dropActivateTimer:void 0}).current,o=h.useRef(s);o.current=s,h.useLayoutEffect(()=>(Ee.set(e,{...Ee.get(e),disabled:n,id:e,ref:t}),()=>{Ee.delete(e)}),[e,o,n,t]);const l=m=>{var v;const g=o.current,p=g.allowDragEventsFromItself||t.current!==((v=m.ref)==null?void 0:v.current);return!!(m!=null&&m.type&&p&&g.types.includes(m.type)&&(!g.acceptsDrop||g.acceptsDrop(m)))},i=m=>{var p,v;const g=ye(m);g&&((v=(p=o.current).onDragLeave)==null||v.call(p,g))};return{droppableProps:n?{}:{onDragOver:m=>{var p,v;m.preventDefault(),m.stopPropagation();const g=ye(m);g&&l(g)&&((v=(p=o.current).onDragOver)==null||v.call(p,g,m))},onDragEnter:m=>{var p,v;if(m.stopPropagation(),r.dragOverElements.add(m.target),r.dragOverElements.size>1)return;const g=ye(m);g&&l(g)&&((v=(p=o.current).onDragEnter)==null||v.call(p,g),clearTimeout(r.dropActivateTimer),typeof o.current.onDropActivate=="function"&&(r.dropActivateTimer=setTimeout(()=>{var y,x;g&&((x=(y=o.current).onDropActivate)==null||x.call(y,g))},Kr)))},onDragLeave:m=>{m.stopPropagation(),r.dragOverElements.delete(m.target);for(const p of r.dragOverElements)m.currentTarget.contains(p)||r.dragOverElements.delete(p);if(r.dragOverElements.size>0)return;const g=ye(m);g&&l(g)&&(i(m),clearTimeout(r.dropActivateTimer))},onDrop:async m=>{var p,v,y,x;m.preventDefault(),m.stopPropagation(),r.dragOverElements.clear(),i(m),clearTimeout(r.dropActivateTimer);const g=ye(m);if(g)if((v=(p=o.current).onDragLeave)==null||v.call(p,g),!l(g))W.status!=="inactive"&&(W.status="dropFail");else{const w=(x=(y=o.current).onDrop)==null?void 0:x.call(y,g);W.status!=="inactive"&&(W.status=w===!1?"dropFail":"dropSuccess")}}}}}function ye(e){if(W.dragTargetId!=null)return J.get(W.dragTargetId);if(e.dataTransfer.types.includes("Files"))return{type:"nativeFile",el:null,ref:null,getData:()=>Br(Hr(e.dataTransfer))}}const Ur="user",Ra=K(a.jsx("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"MoreVertOutlined");/**
 * react-virtual
 *
 * Copyright (c) TanStack
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ze(){return ze=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},ze.apply(this,arguments)}/**
 * virtual-core
 *
 * Copyright (c) TanStack
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Oe(){return Oe=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Oe.apply(this,arguments)}/**
 * virtual-core
 *
 * Copyright (c) TanStack
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function he(e,n,t){var s,r=(s=t.initialDeps)!=null?s:[],o;return function(){var l;t.key&&t.debug!=null&&t.debug()&&(l=Date.now());var i=e(),c=i.length!==r.length||i.some(function(p,v){return r[v]!==p});if(!c)return o;r=i;var d;if(t.key&&t.debug!=null&&t.debug()&&(d=Date.now()),o=n.apply(void 0,i),t.key&&t.debug!=null&&t.debug()){var u=Math.round((Date.now()-l)*100)/100,f=Math.round((Date.now()-d)*100)/100,m=f/16,g=function(v,y){for(v=String(v);v.length<y;)v=" "+v;return v};console.info("%c "+g(f,5)+" /"+g(u,5)+" ms",`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(`+Math.max(0,Math.min(120-120*m,120))+"deg 100% 31%);",t==null?void 0:t.key)}return t==null||t.onChange==null||t.onChange(o),o}}function Je(e,n){if(e===void 0)throw new Error("Unexpected undefined"+(n?": "+n:""));return e}var _r=function(n,t){return Math.abs(n-t)<1};/**
 * virtual-core
 *
 * Copyright (c) TanStack
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var qr=function(n){return n},Wr=function(n){for(var t=Math.max(n.startIndex-n.overscan,0),s=Math.min(n.endIndex+n.overscan,n.count-1),r=[],o=t;o<=s;o++)r.push(o);return r},Yr=function(n,t){var s=n.scrollElement;if(s){var r=function(i){var c=i.width,d=i.height;t({width:Math.round(c),height:Math.round(d)})};r(s.getBoundingClientRect());var o=new ResizeObserver(function(l){var i=l[0];if(i!=null&&i.borderBoxSize){var c=i.borderBoxSize[0];if(c){r({width:c.inlineSize,height:c.blockSize});return}}r(s.getBoundingClientRect())});return o.observe(s,{box:"border-box"}),function(){o.unobserve(s)}}},Gr=function(n,t){var s=n.scrollElement;if(s){var r=function(){t(s[n.options.horizontal?"scrollLeft":"scrollTop"])};return r(),s.addEventListener("scroll",r,{passive:!0}),function(){s.removeEventListener("scroll",r)}}},Xr=function(n,t,s){if(t!=null&&t.borderBoxSize){var r=t.borderBoxSize[0];if(r){var o=Math.round(r[s.options.horizontal?"inlineSize":"blockSize"]);return o}}return Math.round(n.getBoundingClientRect()[s.options.horizontal?"width":"height"])},Qr=function(n,t,s){var r,o,l=t.adjustments,i=l===void 0?0:l,c=t.behavior,d=n+i;(r=s.scrollElement)==null||r.scrollTo==null||r.scrollTo((o={},o[s.options.horizontal?"left":"top"]=d,o.behavior=c,o))},Zr=function(n){var t=this;this.unsubs=[],this.scrollElement=null,this.isScrolling=!1,this.isScrollingTimeoutId=null,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollDirection=null,this.scrollAdjustments=0,this.measureElementCache=new Map,this.observer=function(){var s=null,r=function(){return s||(typeof ResizeObserver<"u"?s=new ResizeObserver(function(l){l.forEach(function(i){t._measureElement(i.target,i)})}):null)};return{disconnect:function(){var l;return(l=r())==null?void 0:l.disconnect()},observe:function(l){var i;return(i=r())==null?void 0:i.observe(l,{box:"border-box"})},unobserve:function(l){var i;return(i=r())==null?void 0:i.unobserve(l)}}}(),this.range=null,this.setOptions=function(s){Object.entries(s).forEach(function(r){var o=r[0],l=r[1];typeof l>"u"&&delete s[o]}),t.options=Oe({debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:qr,rangeExtractor:Wr,onChange:function(){},measureElement:Xr,initialRect:{width:0,height:0},scrollMargin:0,scrollingDelay:150,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1},s)},this.notify=function(s){t.options.onChange==null||t.options.onChange(t,s)},this.maybeNotify=he(function(){return t.calculateRange(),[t.isScrolling,t.range?t.range.startIndex:null,t.range?t.range.endIndex:null]},function(s){t.notify(s)},{key:!1,debug:function(){return t.options.debug},initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=function(){t.unsubs.filter(Boolean).forEach(function(s){return s()}),t.unsubs=[],t.scrollElement=null},this._didMount=function(){return t.measureElementCache.forEach(t.observer.observe),function(){t.observer.disconnect(),t.cleanup()}},this._willUpdate=function(){var s=t.options.getScrollElement();t.scrollElement!==s&&(t.cleanup(),t.scrollElement=s,t._scrollToOffset(t.scrollOffset,{adjustments:void 0,behavior:void 0}),t.unsubs.push(t.options.observeElementRect(t,function(r){t.scrollRect=r,t.maybeNotify()})),t.unsubs.push(t.options.observeElementOffset(t,function(r){t.scrollAdjustments=0,t.scrollOffset!==r&&(t.isScrollingTimeoutId!==null&&(clearTimeout(t.isScrollingTimeoutId),t.isScrollingTimeoutId=null),t.isScrolling=!0,t.scrollDirection=t.scrollOffset<r?"forward":"backward",t.scrollOffset=r,t.maybeNotify(),t.isScrollingTimeoutId=setTimeout(function(){t.isScrollingTimeoutId=null,t.isScrolling=!1,t.scrollDirection=null,t.maybeNotify()},t.options.scrollingDelay))})))},this.getSize=function(){return t.scrollRect[t.options.horizontal?"width":"height"]},this.memoOptions=he(function(){return[t.options.count,t.options.paddingStart,t.options.scrollMargin,t.options.getItemKey]},function(s,r,o,l){return t.pendingMeasuredCacheIndexes=[],{count:s,paddingStart:r,scrollMargin:o,getItemKey:l}},{key:!1}),this.getFurthestMeasurement=function(s,r){for(var o=new Map,l=new Map,i=r-1;i>=0;i--){var c=s[i];if(!o.has(c.lane)){var d=l.get(c.lane);if(d==null||c.end>d.end?l.set(c.lane,c):c.end<d.end&&o.set(c.lane,!0),o.size===t.options.lanes)break}}return l.size===t.options.lanes?Array.from(l.values()).sort(function(u,f){return u.end-f.end})[0]:void 0},this.getMeasurements=he(function(){return[t.memoOptions(),t.itemSizeCache]},function(s,r){var o=s.count,l=s.paddingStart,i=s.scrollMargin,c=s.getItemKey,d=t.pendingMeasuredCacheIndexes.length>0?Math.min.apply(Math,t.pendingMeasuredCacheIndexes):0;t.pendingMeasuredCacheIndexes=[];for(var u=t.measurementsCache.slice(0,d),f=d;f<o;f++){var m=c(f),g=t.options.lanes===1?u[f-1]:t.getFurthestMeasurement(u,f),p=g?g.end:l+i,v=r.get(m),y=typeof v=="number"?v:t.options.estimateSize(f),x=p+y,w=g?g.lane:f%t.options.lanes;u[f]={index:f,start:p,size:y,end:x,key:m,lane:w}}return t.measurementsCache=u,u},{key:!1,debug:function(){return t.options.debug}}),this.calculateRange=he(function(){return[t.getMeasurements(),t.getSize(),t.scrollOffset]},function(s,r,o){return t.range=s.length>0&&r>0?Jr({measurements:s,outerSize:r,scrollOffset:o}):null},{key:!1,debug:function(){return t.options.debug}}),this.getIndexes=he(function(){return[t.options.rangeExtractor,t.calculateRange(),t.options.overscan,t.options.count]},function(s,r,o,l){return r===null?[]:s(Oe({},r,{overscan:o,count:l}))},{key:!1,debug:function(){return t.options.debug}}),this.indexFromElement=function(s){var r=t.options.indexAttribute,o=s.getAttribute(r);return o?parseInt(o,10):(console.warn("Missing attribute name '"+r+"={index}' on measured element."),-1)},this._measureElement=function(s,r){var o=t.measurementsCache[t.indexFromElement(s)];if(!o||!s.isConnected){t.measureElementCache.forEach(function(c,d){c===s&&(t.observer.unobserve(s),t.measureElementCache.delete(d))});return}var l=t.measureElementCache.get(o.key);l!==s&&(l&&t.observer.unobserve(l),t.observer.observe(s),t.measureElementCache.set(o.key,s));var i=t.options.measureElement(s,r,t);t.resizeItem(o,i)},this.resizeItem=function(s,r){var o,l=(o=t.itemSizeCache.get(s.key))!=null?o:s.size,i=r-l;i!==0&&(s.start<t.scrollOffset&&t._scrollToOffset(t.scrollOffset,{adjustments:t.scrollAdjustments+=i,behavior:void 0}),t.pendingMeasuredCacheIndexes.push(s.index),t.itemSizeCache=new Map(t.itemSizeCache.set(s.key,r)),t.notify(!1))},this.measureElement=function(s){s&&t._measureElement(s,void 0)},this.getVirtualItems=he(function(){return[t.getIndexes(),t.getMeasurements()]},function(s,r){for(var o=[],l=0,i=s.length;l<i;l++){var c=s[l],d=r[c];o.push(d)}return o},{key:!1,debug:function(){return t.options.debug}}),this.getVirtualItemForOffset=function(s){var r=t.getMeasurements();return Je(r[pn(0,r.length-1,function(o){return Je(r[o]).start},s)])},this.getOffsetForAlignment=function(s,r){var o=t.getSize();r==="auto"&&(s<=t.scrollOffset?r="start":s>=t.scrollOffset+o?r="end":r="start"),r==="start"?s=s:r==="end"?s=s-o:r==="center"&&(s=s-o/2);var l=t.options.horizontal?"scrollWidth":"scrollHeight",i=t.scrollElement?"document"in t.scrollElement?t.scrollElement.document.documentElement[l]:t.scrollElement[l]:0,c=i-t.getSize();return Math.max(Math.min(c,s),0)},this.getOffsetForIndex=function(s,r){r===void 0&&(r="auto"),s=Math.max(0,Math.min(s,t.options.count-1));var o=Je(t.getMeasurements()[s]);if(r==="auto")if(o.end>=t.scrollOffset+t.getSize()-t.options.scrollPaddingEnd)r="end";else if(o.start<=t.scrollOffset+t.options.scrollPaddingStart)r="start";else return[t.scrollOffset,r];var l=r==="end"?o.end+t.options.scrollPaddingEnd:o.start-t.options.scrollPaddingStart;return[t.getOffsetForAlignment(l,r),r]},this.isDynamicMode=function(){return t.measureElementCache.size>0},this.cancelScrollToIndex=function(){t.scrollToIndexTimeoutId!==null&&(clearTimeout(t.scrollToIndexTimeoutId),t.scrollToIndexTimeoutId=null)},this.scrollToOffset=function(s,r){var o=r===void 0?{}:r,l=o.align,i=l===void 0?"start":l,c=o.behavior;t.cancelScrollToIndex(),c==="smooth"&&t.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),t._scrollToOffset(t.getOffsetForAlignment(s,i),{adjustments:void 0,behavior:c})},this.scrollToIndex=function(s,r){var o=r===void 0?{}:r,l=o.align,i=l===void 0?"auto":l,c=o.behavior;s=Math.max(0,Math.min(s,t.options.count-1)),t.cancelScrollToIndex(),c==="smooth"&&t.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");var d=t.getOffsetForIndex(s,i),u=d[0],f=d[1];t._scrollToOffset(u,{adjustments:void 0,behavior:c}),c!=="smooth"&&t.isDynamicMode()&&(t.scrollToIndexTimeoutId=setTimeout(function(){t.scrollToIndexTimeoutId=null;var m=t.measureElementCache.has(t.options.getItemKey(s));if(m){var g=t.getOffsetForIndex(s,f),p=g[0];_r(p,t.scrollOffset)||t.scrollToIndex(s,{align:f,behavior:c})}else t.scrollToIndex(s,{align:f,behavior:c})}))},this.scrollBy=function(s,r){var o=r===void 0?{}:r,l=o.behavior;t.cancelScrollToIndex(),l==="smooth"&&t.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),t._scrollToOffset(t.scrollOffset+s,{adjustments:void 0,behavior:l})},this.getTotalSize=function(){var s;return(((s=t.getMeasurements()[t.options.count-1])==null?void 0:s.end)||t.options.paddingStart)-t.options.scrollMargin+t.options.paddingEnd},this._scrollToOffset=function(s,r){var o=r.adjustments,l=r.behavior;t.options.scrollToFn(s,{behavior:l,adjustments:o},t)},this.measure=function(){t.itemSizeCache=new Map,t.notify(!1)},this.setOptions(n),this.scrollRect=this.options.initialRect,this.scrollOffset=this.options.initialOffset,this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(function(s){t.itemSizeCache.set(s.key,s.size)}),this.maybeNotify()},pn=function(n,t,s,r){for(;n<=t;){var o=(n+t)/2|0,l=s(o);if(l<r)n=o+1;else if(l>r)t=o-1;else return o}return n>0?n-1:0};function Jr(e){for(var n=e.measurements,t=e.outerSize,s=e.scrollOffset,r=n.length-1,o=function(d){return n[d].start},l=pn(0,r,o,s),i=l;i<r&&n[i].end<s+t;)i++;return{startIndex:l,endIndex:i}}/**
 * react-virtual
 *
 * Copyright (c) TanStack
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var ea=typeof document<"u"?h.useLayoutEffect:h.useEffect;function ta(e){var n=h.useReducer(function(){return{}},{})[1],t=ze({},e,{onChange:function(l,i){i?as.flushSync(n):n(),e.onChange==null||e.onChange(l,i)}}),s=h.useState(function(){return new Zr(t)}),r=s[0];return r.setOptions(t),h.useEffect(function(){return r._didMount()},[]),ea(function(){return r._willUpdate()}),r}function Na(e){return ta(ze({observeElementRect:Yr,observeElementOffset:Gr,scrollToFn:Qr},e))}const na=fe.createContext(null);function se(e,n){const{base_url:t}=Ft(),s=h.useContext(na);return h.useMemo(()=>{if(!e)return{};let r;e.url&&(r=os(e.url)?e.url:`${t}/${e.url}`);const o={previewUrl:r,downloadUrl:`${t}/api/v1/file-entries/download/${(n==null?void 0:n.downloadHashes)||e.hash}`};return s&&(o.previewUrl&&(o.previewUrl=Pt(o.previewUrl,{...s,thumbnail:n!=null&&n.thumbnail?"true":""},t)),o.downloadUrl=Pt(o.downloadUrl,s,t)),o},[t,e,n==null?void 0:n.downloadHashes,n==null?void 0:n.thumbnail,s])}function Pt(e,n,t){const s=new URL(e,t);return Object.entries(n).forEach(([r,o])=>{s.searchParams.append(r,o)}),s.toString()}const pt=fe.createContext(null);function te({message:e,className:n,allowDownload:t}){const{entries:s,activeIndex:r}=h.useContext(pt),o=s[r],l=e||a.jsx(O,{message:"No file preview available"}),{downloadUrl:i}=se(o);return a.jsxs("div",{className:E(n,"shadow bg-paper max-w-400 w-[calc(100%-40px)] text-center p-40 rounded"),children:[a.jsx("div",{className:"text-lg",children:l}),t&&a.jsx("div",{className:"block mt-20 text-center",children:a.jsx(ee,{variant:"flat",color:"primary",onClick:()=>{i&&rt(i)},children:a.jsx(O,{message:"Download"})})})]})}function sa(e){const{entry:n,className:t}=e,{trans:s}=U(),{previewUrl:r}=se(n);return r?a.jsx("img",{className:E(t,"shadow"),src:r,alt:s({message:"Preview for :name",values:{name:n.name}})}):a.jsx(te,{...e})}const ra=5242880;function aa(e){const{entry:n,className:t}=e,{trans:s}=U(),[r,o]=h.useState(!1),[l,i]=h.useState(!0),[c,d]=h.useState(!1),[u,f]=h.useState(null),{previewUrl:m}=se(n);return h.useEffect(()=>{n&&(m?n.file_size>=ra?(o(!0),i(!1)):oa(m).then(g=>{f(g.data)}).catch(()=>{d(!0)}).finally(()=>{i(!1)}):d(!0))},[n,m]),l?a.jsx(He,{isIndeterminate:!0,"aria-label":s({message:"Loading file contents"})}):r?a.jsx(te,{...e,message:a.jsx(O,{message:"This file is too large to preview."})}):c?a.jsx(te,{...e,message:a.jsx(O,{message:"There was an issue previewing this file"})}):a.jsx("pre",{className:E("rounded bg-paper p-20 text-sm whitespace-pre-wrap break-words h-full overflow-y-auto w-full",t),children:a.jsx("div",{className:"container mx-auto",children:`${u}`})})}function oa(e){return Ue.get(e,{responseType:"text",withCredentials:!1,headers:{Accept:"text/plain"}})}function la(e){const{entry:n,className:t}=e,{previewUrl:s}=se(n),r=h.useRef(null),[o,l]=h.useState(!1);return h.useEffect(()=>{var i;l(!((i=r.current)!=null&&i.canPlayType(n.mime)))},[n]),o||!s?a.jsx(te,{...e}):a.jsx("video",{className:t,ref:r,controls:!0,controlsList:"nodownload noremoteplayback",playsInline:!0,autoPlay:!0,children:a.jsx("source",{src:s,type:n.mime,onError:()=>{l(!0)}})})}function ia(e){const{entry:n,className:t}=e,{previewUrl:s}=se(n),r=h.useRef(null),[o,l]=h.useState(!1);return h.useEffect(()=>{var i;l(!((i=r.current)!=null&&i.canPlayType(n.mime)))},[n]),o||!s?a.jsx(te,{...e}):a.jsx("audio",{className:t,ref:r,controls:!0,controlsList:"nodownload noremoteplayback",autoPlay:!0,children:a.jsx("source",{src:s,type:n.mime,onError:()=>{l(!0)}})})}function ca(e){const{entry:n,className:t}=e,{trans:s}=U(),{previewUrl:r}=se(n);return r?a.jsx("iframe",{title:s({message:"Preview for :name",values:{name:n.name}}),className:E(t,"w-full h-full"),src:`${r}#toolbar=0`}):a.jsx(te,{...e})}function et(e){const{entry:n,className:t}=e,{trans:s}=U(),r=h.useRef(null),[o,l]=h.useState(!1),i=h.useRef(),[c,d]=h.useState(!1),{previewUrl:u}=se(n);return h.useEffect(()=>{u?n.file_size&&n.file_size>25e6?l(!0):r.current&&(r.current.onload=()=>{clearTimeout(i.current),d(!1)},ua(u,n).then(f=>{r.current&&(r.current.src=f)}),i.current=setTimeout(()=>{l(!0)},5e3)):l(!0)},[n,u]),o?a.jsx(te,{...e}):a.jsxs("div",{className:E(t,"w-full h-full"),children:[c&&a.jsx(He,{}),a.jsx("iframe",{ref:r,title:s({message:"Preview for :name",values:{name:n.name}}),className:E("w-full h-full",c&&"hidden")})]})}async function ua(e,n){const t=new URL(e);if(!t.searchParams.has("shareable_link")){const{data:s}=await Ue.post(`file-entries/${n.id}/add-preview-token`);t.searchParams.append("preview_token",s.preview_token)}return da(t)}function da(e){return`https://view.officeapps.live.com/op/embed.aspx?src=${encodeURIComponent(e.toString())}`}const St={text:aa,video:la,audio:ia,image:sa,pdf:ca,spreadsheet:et,powerPoint:et,word:et,"text/rtf":te};function fa(e){const n=e==null?void 0:e.mime,t=e==null?void 0:e.type;return St[n]||St[t]||te}const ha=K(a.jsx("path",{d:"M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12l4.58-4.59z"}),"ChevronLeftOutlined"),ma=2*1024*1024;function ga({file:e,className:n,iconClassName:t,showImage:s=!0}){const{trans:r}=U(),{previewUrl:o}=se(e,{thumbnail:!0});if(e.file_size&&e.file_size>ma&&!e.thumbnail&&(s=!1),s&&e.type==="image"&&o){const l=r({message:":fileName thumbnail",values:{fileName:e.name}});return a.jsx("img",{className:E(n,"object-cover"),src:o,alt:l,draggable:!1})}return a.jsx(ls,{className:t,type:e.type})}function pa({entries:e,onClose:n,showHeader:t=!0,className:s,headerActionsLeft:r,allowDownload:o=!0,...l}){const i=At("(max-width: 1024px)"),[c,d]=ue(l.activeIndex,l.defaultActiveIndex||0,l.onActiveIndexChange),u=e[c],f=h.useMemo(()=>({entries:e,activeIndex:c}),[e,c]),m=fa(u);if(!u)return n==null||n(),null;const g=e.length-1>c,p=()=>{d(c+1)},v=c>0,y=()=>{d(c-1)};return a.jsxs(pt.Provider,{value:f,children:[t&&a.jsx(xa,{actionsLeft:r,isMobile:i,onClose:n,onNext:g?p:void 0,onPrevious:v?y:void 0,allowDownload:o}),a.jsxs("div",{className:E("overflow-hidden relative flex-auto",s),children:[i&&a.jsx(Q,{size:"lg",className:"text-muted absolute left-0 top-1/2 transform -translate-y-1/2 z-10",disabled:!v,onClick:y,children:a.jsx(Jt,{})}),a.jsx(Le,{initial:!1,children:a.jsx(ge.div,{className:"absolute inset-0 flex items-center justify-center",...ft,children:a.jsx(m,{className:"max-h-[calc(100%-30px)]",entry:u,allowDownload:o})},u.id)}),i&&a.jsx(Q,{size:"lg",className:"text-muted absolute right-0 top-1/2 transform -translate-y-1/2 z-10",disabled:!g,onClick:p,children:a.jsx(en,{})})]})]})}function xa({onNext:e,onPrevious:n,onClose:t,isMobile:s,actionsLeft:r,allowDownload:o}){const{entries:l,activeIndex:i}=h.useContext(pt),c=l[i],{downloadUrl:d}=se(c),m=s?a.jsx(Q,{onClick:()=>{d&&rt(d)},children:a.jsx(It,{})}):a.jsx(ee,{startIcon:a.jsx(It,{}),variant:"text",onClick:()=>{d&&rt(d)},children:a.jsx(O,{message:"Download"})});return a.jsxs("div",{className:"flex items-center justify-between gap-20 bg-paper border-b flex-shrink-0 text-sm min-h-50 px-10 text-muted",children:[a.jsxs("div",{className:"flex items-center gap-4 w-1/3 justify-start",children:[r,o?m:void 0]}),a.jsxs("div",{className:"flex items-center gap-10 w-1/3 justify-center flex-nowrap text-main",children:[a.jsx(ga,{file:c,iconClassName:"w-16 h-16",showImage:!1}),a.jsx("div",{className:"whitespace-nowrap overflow-hidden overflow-ellipsis",children:c.name})]}),a.jsxs("div",{className:"w-1/3 flex items-center gap-10 justify-end whitespace-nowrap",children:[!s&&a.jsxs(h.Fragment,{children:[a.jsx(Q,{disabled:!n,onClick:n,children:a.jsx(ha,{})}),a.jsx("div",{children:i+1}),a.jsx("div",{children:"/"}),a.jsx("div",{children:l.length}),a.jsx(Q,{disabled:!e,onClick:e,children:a.jsx(cs,{})}),a.jsx("div",{className:"bg-divider w-1 h-24 mx-20"})]}),a.jsx(Q,{radius:"rounded-none",onClick:t,children:a.jsx(qt,{})})]})]})}function Fa(e){return a.jsx(Ve,{size:"fullscreenTakeover",background:"bg-alt",className:"flex flex-col",children:a.jsx(va,{...e})})}function va(e){const{close:n}=it();return a.jsx(pa,{onClose:n,...e})}const ba={key:"type",label:C("Type"),description:C("Type of the file"),defaultOperator:Ie.eq,control:{type:B.Select,defaultValue:"05",options:[{key:"02",label:C("Text"),value:"text"},{key:"03",label:C("Audio"),value:"audio"},{key:"04",label:C("Video"),value:"video"},{key:"05",label:C("Image"),value:"image"},{key:"06",label:C("PDF"),value:"pdf"},{key:"07",label:C("Spreadsheet"),value:"spreadsheet"},{key:"08",label:C("Word Document"),value:"word"},{key:"09",label:C("Photoshop"),value:"photoshop"},{key:"10",label:C("Archive"),value:"archive"},{key:"11",label:C("Folder"),value:"folder"}]}},za=[ba,{key:"public",label:C("Visibility"),description:C("Whether file is publicly accessible"),defaultOperator:Ie.eq,control:{type:B.Select,defaultValue:"01",options:[{key:"01",label:C("Private"),value:!1},{key:"02",label:C("Public"),value:!0}]}},Fs({description:C("Date file was uploaded")}),zs({description:C("Date file was last changed")}),{key:"owner_id",label:C("Uploader"),description:C("User that this file was uploaded by"),defaultOperator:Ie.eq,control:{type:B.SelectModel,model:Ur}}],Oa=K(a.jsx("path",{d:"M17 7h-4v2h4c1.65 0 3 1.35 3 3s-1.35 3-3 3h-4v2h4c2.76 0 5-2.24 5-5s-2.24-5-5-5zm-6 8H7c-1.65 0-3-1.35-3-3s1.35-3 3-3h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-2zm-3-4h8v2H8z"}),"LinkOutlined"),$a=K(a.jsx("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"}),"ArrowBackOutlined");export{er as $,Ia as A,Qe as B,wr as C,ja as D,Fa as E,Ie as F,an as G,dr as H,hr as I,$a as J,Jt as K,Oa as L,Ra as M,fr as N,se as O,ga as P,Z as Q,pa as R,ln as S,Ca as T,Ur as U,na as V,ba as W,Bs as X,hn as Y,Ks as Z,Fe as _,B as a,Ar as a0,Ir as a1,Gt as a2,nn as a3,fs as a4,Is as a5,Ps as a6,ht as a7,Xs as a8,Zt as a9,ha as aa,en as b,Fs as c,Ms as d,sr as e,nr as f,Da as g,rt as h,It as i,_e as j,Pa as k,ka as l,mr as m,Ta as n,Ea as o,Vr as p,Ee as q,yr as r,Sa as s,sn as t,zs as u,cn as v,br as w,Na as x,ar as y,za as z};
//# sourceMappingURL=ArrowBack-1cb088fd.js.map
